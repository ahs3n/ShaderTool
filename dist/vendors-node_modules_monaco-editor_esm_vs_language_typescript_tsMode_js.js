"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["vendors-node_modules_monaco-editor_esm_vs_language_typescript_tsMode_js"],{

/***/ "./node_modules/monaco-editor/esm/vs/language/typescript/tsMode.js":
/*!*************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/language/typescript/tsMode.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Adapter: () => (/* binding */ Adapter),\n/* harmony export */   CodeActionAdaptor: () => (/* binding */ CodeActionAdaptor),\n/* harmony export */   DefinitionAdapter: () => (/* binding */ DefinitionAdapter),\n/* harmony export */   DiagnosticsAdapter: () => (/* binding */ DiagnosticsAdapter),\n/* harmony export */   DocumentHighlightAdapter: () => (/* binding */ DocumentHighlightAdapter),\n/* harmony export */   FormatAdapter: () => (/* binding */ FormatAdapter),\n/* harmony export */   FormatHelper: () => (/* binding */ FormatHelper),\n/* harmony export */   FormatOnTypeAdapter: () => (/* binding */ FormatOnTypeAdapter),\n/* harmony export */   InlayHintsAdapter: () => (/* binding */ InlayHintsAdapter),\n/* harmony export */   Kind: () => (/* binding */ Kind),\n/* harmony export */   LibFiles: () => (/* binding */ LibFiles),\n/* harmony export */   OutlineAdapter: () => (/* binding */ OutlineAdapter),\n/* harmony export */   QuickInfoAdapter: () => (/* binding */ QuickInfoAdapter),\n/* harmony export */   ReferenceAdapter: () => (/* binding */ ReferenceAdapter),\n/* harmony export */   RenameAdapter: () => (/* binding */ RenameAdapter),\n/* harmony export */   SignatureHelpAdapter: () => (/* binding */ SignatureHelpAdapter),\n/* harmony export */   SuggestAdapter: () => (/* binding */ SuggestAdapter),\n/* harmony export */   WorkerManager: () => (/* binding */ WorkerManager),\n/* harmony export */   flattenDiagnosticMessageText: () => (/* binding */ flattenDiagnosticMessageText),\n/* harmony export */   getJavaScriptWorker: () => (/* binding */ getJavaScriptWorker),\n/* harmony export */   getTypeScriptWorker: () => (/* binding */ getTypeScriptWorker),\n/* harmony export */   setupJavaScript: () => (/* binding */ setupJavaScript),\n/* harmony export */   setupTypeScript: () => (/* binding */ setupTypeScript)\n/* harmony export */ });\n/* harmony import */ var _editor_editor_api_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../editor/editor.api.js */ \"./node_modules/monaco-editor/esm/vs/editor/editor.api.js\");\n/* harmony import */ var _monaco_contribution_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./monaco.contribution.js */ \"./node_modules/monaco-editor/esm/vs/language/typescript/monaco.contribution.js\");\n/*!-----------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Version: 0.50.0(c321d0fbecb50ab8a5365fa1965476b0ae63fc87)\r\n * Released under the MIT license\r\n * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt\r\n *-----------------------------------------------------------------------------*/\r\n\r\nvar __defProp = Object.defineProperty;\r\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\r\nvar __getOwnPropNames = Object.getOwnPropertyNames;\r\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\r\nvar __copyProps = (to, from, except, desc) => {\r\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\r\n    for (let key of __getOwnPropNames(from))\r\n      if (!__hasOwnProp.call(to, key) && key !== except)\r\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\r\n  }\r\n  return to;\r\n};\r\nvar __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, \"default\"), secondTarget && __copyProps(secondTarget, mod, \"default\"));\r\n\r\n// src/fillers/monaco-editor-core.ts\r\nvar monaco_editor_core_exports = {};\r\n__reExport(monaco_editor_core_exports, _editor_editor_api_js__WEBPACK_IMPORTED_MODULE_0__);\r\n\r\n\r\n// src/language/typescript/workerManager.ts\r\nvar WorkerManager = class {\r\n  constructor(_modeId, _defaults) {\r\n    this._modeId = _modeId;\r\n    this._defaults = _defaults;\r\n    this._worker = null;\r\n    this._client = null;\r\n    this._configChangeListener = this._defaults.onDidChange(() => this._stopWorker());\r\n    this._updateExtraLibsToken = 0;\r\n    this._extraLibsChangeListener = this._defaults.onDidExtraLibsChange(\r\n      () => this._updateExtraLibs()\r\n    );\r\n  }\r\n  dispose() {\r\n    this._configChangeListener.dispose();\r\n    this._extraLibsChangeListener.dispose();\r\n    this._stopWorker();\r\n  }\r\n  _stopWorker() {\r\n    if (this._worker) {\r\n      this._worker.dispose();\r\n      this._worker = null;\r\n    }\r\n    this._client = null;\r\n  }\r\n  async _updateExtraLibs() {\r\n    if (!this._worker) {\r\n      return;\r\n    }\r\n    const myToken = ++this._updateExtraLibsToken;\r\n    const proxy = await this._worker.getProxy();\r\n    if (this._updateExtraLibsToken !== myToken) {\r\n      return;\r\n    }\r\n    proxy.updateExtraLibs(this._defaults.getExtraLibs());\r\n  }\r\n  _getClient() {\r\n    if (!this._client) {\r\n      this._client = (async () => {\r\n        this._worker = monaco_editor_core_exports.editor.createWebWorker({\r\n          // module that exports the create() method and returns a `TypeScriptWorker` instance\r\n          moduleId: \"vs/language/typescript/tsWorker\",\r\n          label: this._modeId,\r\n          keepIdleModels: true,\r\n          // passed in to the create() method\r\n          createData: {\r\n            compilerOptions: this._defaults.getCompilerOptions(),\r\n            extraLibs: this._defaults.getExtraLibs(),\r\n            customWorkerPath: this._defaults.workerOptions.customWorkerPath,\r\n            inlayHintsOptions: this._defaults.inlayHintsOptions\r\n          }\r\n        });\r\n        if (this._defaults.getEagerModelSync()) {\r\n          return await this._worker.withSyncedResources(\r\n            monaco_editor_core_exports.editor.getModels().filter((model) => model.getLanguageId() === this._modeId).map((model) => model.uri)\r\n          );\r\n        }\r\n        return await this._worker.getProxy();\r\n      })();\r\n    }\r\n    return this._client;\r\n  }\r\n  async getLanguageServiceWorker(...resources) {\r\n    const client = await this._getClient();\r\n    if (this._worker) {\r\n      await this._worker.withSyncedResources(resources);\r\n    }\r\n    return client;\r\n  }\r\n};\r\n\r\n// src/language/typescript/languageFeatures.ts\r\n\r\n\r\n// src/language/typescript/lib/lib.index.ts\r\nvar libFileSet = {};\r\nlibFileSet[\"lib.d.ts\"] = true;\r\nlibFileSet[\"lib.decorators.d.ts\"] = true;\r\nlibFileSet[\"lib.decorators.legacy.d.ts\"] = true;\r\nlibFileSet[\"lib.dom.asynciterable.d.ts\"] = true;\r\nlibFileSet[\"lib.dom.d.ts\"] = true;\r\nlibFileSet[\"lib.dom.iterable.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.collection.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.core.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.generator.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.iterable.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.promise.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.proxy.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.reflect.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.symbol.d.ts\"] = true;\r\nlibFileSet[\"lib.es2015.symbol.wellknown.d.ts\"] = true;\r\nlibFileSet[\"lib.es2016.array.include.d.ts\"] = true;\r\nlibFileSet[\"lib.es2016.d.ts\"] = true;\r\nlibFileSet[\"lib.es2016.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2016.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.date.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.object.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.sharedmemory.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.string.d.ts\"] = true;\r\nlibFileSet[\"lib.es2017.typedarrays.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.asyncgenerator.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.asynciterable.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.promise.d.ts\"] = true;\r\nlibFileSet[\"lib.es2018.regexp.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.array.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.object.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.string.d.ts\"] = true;\r\nlibFileSet[\"lib.es2019.symbol.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.bigint.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.date.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.number.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.promise.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.sharedmemory.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.string.d.ts\"] = true;\r\nlibFileSet[\"lib.es2020.symbol.wellknown.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.promise.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.string.d.ts\"] = true;\r\nlibFileSet[\"lib.es2021.weakref.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.array.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.error.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.object.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.regexp.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.sharedmemory.d.ts\"] = true;\r\nlibFileSet[\"lib.es2022.string.d.ts\"] = true;\r\nlibFileSet[\"lib.es2023.array.d.ts\"] = true;\r\nlibFileSet[\"lib.es2023.collection.d.ts\"] = true;\r\nlibFileSet[\"lib.es2023.d.ts\"] = true;\r\nlibFileSet[\"lib.es2023.full.d.ts\"] = true;\r\nlibFileSet[\"lib.es5.d.ts\"] = true;\r\nlibFileSet[\"lib.es6.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.collection.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.decorators.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.disposable.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.full.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.intl.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.object.d.ts\"] = true;\r\nlibFileSet[\"lib.esnext.promise.d.ts\"] = true;\r\nlibFileSet[\"lib.scripthost.d.ts\"] = true;\r\nlibFileSet[\"lib.webworker.asynciterable.d.ts\"] = true;\r\nlibFileSet[\"lib.webworker.d.ts\"] = true;\r\nlibFileSet[\"lib.webworker.importscripts.d.ts\"] = true;\r\nlibFileSet[\"lib.webworker.iterable.d.ts\"] = true;\r\n\r\n// src/language/typescript/languageFeatures.ts\r\nfunction flattenDiagnosticMessageText(diag, newLine, indent = 0) {\r\n  if (typeof diag === \"string\") {\r\n    return diag;\r\n  } else if (diag === void 0) {\r\n    return \"\";\r\n  }\r\n  let result = \"\";\r\n  if (indent) {\r\n    result += newLine;\r\n    for (let i = 0; i < indent; i++) {\r\n      result += \"  \";\r\n    }\r\n  }\r\n  result += diag.messageText;\r\n  indent++;\r\n  if (diag.next) {\r\n    for (const kid of diag.next) {\r\n      result += flattenDiagnosticMessageText(kid, newLine, indent);\r\n    }\r\n  }\r\n  return result;\r\n}\r\nfunction displayPartsToString(displayParts) {\r\n  if (displayParts) {\r\n    return displayParts.map((displayPart) => displayPart.text).join(\"\");\r\n  }\r\n  return \"\";\r\n}\r\nvar Adapter = class {\r\n  constructor(_worker) {\r\n    this._worker = _worker;\r\n  }\r\n  // protected _positionToOffset(model: editor.ITextModel, position: monaco.IPosition): number {\r\n  // \treturn model.getOffsetAt(position);\r\n  // }\r\n  // protected _offsetToPosition(model: editor.ITextModel, offset: number): monaco.IPosition {\r\n  // \treturn model.getPositionAt(offset);\r\n  // }\r\n  _textSpanToRange(model, span) {\r\n    let p1 = model.getPositionAt(span.start);\r\n    let p2 = model.getPositionAt(span.start + span.length);\r\n    let { lineNumber: startLineNumber, column: startColumn } = p1;\r\n    let { lineNumber: endLineNumber, column: endColumn } = p2;\r\n    return { startLineNumber, startColumn, endLineNumber, endColumn };\r\n  }\r\n};\r\nvar LibFiles = class {\r\n  constructor(_worker) {\r\n    this._worker = _worker;\r\n    this._libFiles = {};\r\n    this._hasFetchedLibFiles = false;\r\n    this._fetchLibFilesPromise = null;\r\n  }\r\n  isLibFile(uri) {\r\n    if (!uri) {\r\n      return false;\r\n    }\r\n    if (uri.path.indexOf(\"/lib.\") === 0) {\r\n      return !!libFileSet[uri.path.slice(1)];\r\n    }\r\n    return false;\r\n  }\r\n  getOrCreateModel(fileName) {\r\n    const uri = monaco_editor_core_exports.Uri.parse(fileName);\r\n    const model = monaco_editor_core_exports.editor.getModel(uri);\r\n    if (model) {\r\n      return model;\r\n    }\r\n    if (this.isLibFile(uri) && this._hasFetchedLibFiles) {\r\n      return monaco_editor_core_exports.editor.createModel(this._libFiles[uri.path.slice(1)], \"typescript\", uri);\r\n    }\r\n    const matchedLibFile = _monaco_contribution_js__WEBPACK_IMPORTED_MODULE_1__.typescriptDefaults.getExtraLibs()[fileName];\r\n    if (matchedLibFile) {\r\n      return monaco_editor_core_exports.editor.createModel(matchedLibFile.content, \"typescript\", uri);\r\n    }\r\n    return null;\r\n  }\r\n  _containsLibFile(uris) {\r\n    for (let uri of uris) {\r\n      if (this.isLibFile(uri)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  async fetchLibFilesIfNecessary(uris) {\r\n    if (!this._containsLibFile(uris)) {\r\n      return;\r\n    }\r\n    await this._fetchLibFiles();\r\n  }\r\n  _fetchLibFiles() {\r\n    if (!this._fetchLibFilesPromise) {\r\n      this._fetchLibFilesPromise = this._worker().then((w) => w.getLibFiles()).then((libFiles) => {\r\n        this._hasFetchedLibFiles = true;\r\n        this._libFiles = libFiles;\r\n      });\r\n    }\r\n    return this._fetchLibFilesPromise;\r\n  }\r\n};\r\nvar DiagnosticsAdapter = class extends Adapter {\r\n  constructor(_libFiles, _defaults, _selector, worker) {\r\n    super(worker);\r\n    this._libFiles = _libFiles;\r\n    this._defaults = _defaults;\r\n    this._selector = _selector;\r\n    this._disposables = [];\r\n    this._listener = /* @__PURE__ */ Object.create(null);\r\n    const onModelAdd = (model) => {\r\n      if (model.getLanguageId() !== _selector) {\r\n        return;\r\n      }\r\n      const maybeValidate = () => {\r\n        const { onlyVisible } = this._defaults.getDiagnosticsOptions();\r\n        if (onlyVisible) {\r\n          if (model.isAttachedToEditor()) {\r\n            this._doValidate(model);\r\n          }\r\n        } else {\r\n          this._doValidate(model);\r\n        }\r\n      };\r\n      let handle;\r\n      const changeSubscription = model.onDidChangeContent(() => {\r\n        clearTimeout(handle);\r\n        handle = window.setTimeout(maybeValidate, 500);\r\n      });\r\n      const visibleSubscription = model.onDidChangeAttached(() => {\r\n        const { onlyVisible } = this._defaults.getDiagnosticsOptions();\r\n        if (onlyVisible) {\r\n          if (model.isAttachedToEditor()) {\r\n            maybeValidate();\r\n          } else {\r\n            monaco_editor_core_exports.editor.setModelMarkers(model, this._selector, []);\r\n          }\r\n        }\r\n      });\r\n      this._listener[model.uri.toString()] = {\r\n        dispose() {\r\n          changeSubscription.dispose();\r\n          visibleSubscription.dispose();\r\n          clearTimeout(handle);\r\n        }\r\n      };\r\n      maybeValidate();\r\n    };\r\n    const onModelRemoved = (model) => {\r\n      monaco_editor_core_exports.editor.setModelMarkers(model, this._selector, []);\r\n      const key = model.uri.toString();\r\n      if (this._listener[key]) {\r\n        this._listener[key].dispose();\r\n        delete this._listener[key];\r\n      }\r\n    };\r\n    this._disposables.push(\r\n      monaco_editor_core_exports.editor.onDidCreateModel((model) => onModelAdd(model))\r\n    );\r\n    this._disposables.push(monaco_editor_core_exports.editor.onWillDisposeModel(onModelRemoved));\r\n    this._disposables.push(\r\n      monaco_editor_core_exports.editor.onDidChangeModelLanguage((event) => {\r\n        onModelRemoved(event.model);\r\n        onModelAdd(event.model);\r\n      })\r\n    );\r\n    this._disposables.push({\r\n      dispose() {\r\n        for (const model of monaco_editor_core_exports.editor.getModels()) {\r\n          onModelRemoved(model);\r\n        }\r\n      }\r\n    });\r\n    const recomputeDiagostics = () => {\r\n      for (const model of monaco_editor_core_exports.editor.getModels()) {\r\n        onModelRemoved(model);\r\n        onModelAdd(model);\r\n      }\r\n    };\r\n    this._disposables.push(this._defaults.onDidChange(recomputeDiagostics));\r\n    this._disposables.push(this._defaults.onDidExtraLibsChange(recomputeDiagostics));\r\n    monaco_editor_core_exports.editor.getModels().forEach((model) => onModelAdd(model));\r\n  }\r\n  dispose() {\r\n    this._disposables.forEach((d) => d && d.dispose());\r\n    this._disposables = [];\r\n  }\r\n  async _doValidate(model) {\r\n    const worker = await this._worker(model.uri);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const promises = [];\r\n    const { noSyntaxValidation, noSemanticValidation, noSuggestionDiagnostics } = this._defaults.getDiagnosticsOptions();\r\n    if (!noSyntaxValidation) {\r\n      promises.push(worker.getSyntacticDiagnostics(model.uri.toString()));\r\n    }\r\n    if (!noSemanticValidation) {\r\n      promises.push(worker.getSemanticDiagnostics(model.uri.toString()));\r\n    }\r\n    if (!noSuggestionDiagnostics) {\r\n      promises.push(worker.getSuggestionDiagnostics(model.uri.toString()));\r\n    }\r\n    const allDiagnostics = await Promise.all(promises);\r\n    if (!allDiagnostics || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const diagnostics = allDiagnostics.reduce((p, c) => c.concat(p), []).filter(\r\n      (d) => (this._defaults.getDiagnosticsOptions().diagnosticCodesToIgnore || []).indexOf(d.code) === -1\r\n    );\r\n    const relatedUris = diagnostics.map((d) => d.relatedInformation || []).reduce((p, c) => c.concat(p), []).map(\r\n      (relatedInformation) => relatedInformation.file ? monaco_editor_core_exports.Uri.parse(relatedInformation.file.fileName) : null\r\n    );\r\n    await this._libFiles.fetchLibFilesIfNecessary(relatedUris);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    monaco_editor_core_exports.editor.setModelMarkers(\r\n      model,\r\n      this._selector,\r\n      diagnostics.map((d) => this._convertDiagnostics(model, d))\r\n    );\r\n  }\r\n  _convertDiagnostics(model, diag) {\r\n    const diagStart = diag.start || 0;\r\n    const diagLength = diag.length || 1;\r\n    const { lineNumber: startLineNumber, column: startColumn } = model.getPositionAt(diagStart);\r\n    const { lineNumber: endLineNumber, column: endColumn } = model.getPositionAt(\r\n      diagStart + diagLength\r\n    );\r\n    const tags = [];\r\n    if (diag.reportsUnnecessary) {\r\n      tags.push(monaco_editor_core_exports.MarkerTag.Unnecessary);\r\n    }\r\n    if (diag.reportsDeprecated) {\r\n      tags.push(monaco_editor_core_exports.MarkerTag.Deprecated);\r\n    }\r\n    return {\r\n      severity: this._tsDiagnosticCategoryToMarkerSeverity(diag.category),\r\n      startLineNumber,\r\n      startColumn,\r\n      endLineNumber,\r\n      endColumn,\r\n      message: flattenDiagnosticMessageText(diag.messageText, \"\\n\"),\r\n      code: diag.code.toString(),\r\n      tags,\r\n      relatedInformation: this._convertRelatedInformation(model, diag.relatedInformation)\r\n    };\r\n  }\r\n  _convertRelatedInformation(model, relatedInformation) {\r\n    if (!relatedInformation) {\r\n      return [];\r\n    }\r\n    const result = [];\r\n    relatedInformation.forEach((info) => {\r\n      let relatedResource = model;\r\n      if (info.file) {\r\n        relatedResource = this._libFiles.getOrCreateModel(info.file.fileName);\r\n      }\r\n      if (!relatedResource) {\r\n        return;\r\n      }\r\n      const infoStart = info.start || 0;\r\n      const infoLength = info.length || 1;\r\n      const { lineNumber: startLineNumber, column: startColumn } = relatedResource.getPositionAt(infoStart);\r\n      const { lineNumber: endLineNumber, column: endColumn } = relatedResource.getPositionAt(\r\n        infoStart + infoLength\r\n      );\r\n      result.push({\r\n        resource: relatedResource.uri,\r\n        startLineNumber,\r\n        startColumn,\r\n        endLineNumber,\r\n        endColumn,\r\n        message: flattenDiagnosticMessageText(info.messageText, \"\\n\")\r\n      });\r\n    });\r\n    return result;\r\n  }\r\n  _tsDiagnosticCategoryToMarkerSeverity(category) {\r\n    switch (category) {\r\n      case 1 /* Error */:\r\n        return monaco_editor_core_exports.MarkerSeverity.Error;\r\n      case 3 /* Message */:\r\n        return monaco_editor_core_exports.MarkerSeverity.Info;\r\n      case 0 /* Warning */:\r\n        return monaco_editor_core_exports.MarkerSeverity.Warning;\r\n      case 2 /* Suggestion */:\r\n        return monaco_editor_core_exports.MarkerSeverity.Hint;\r\n    }\r\n    return monaco_editor_core_exports.MarkerSeverity.Info;\r\n  }\r\n};\r\nvar SuggestAdapter = class _SuggestAdapter extends Adapter {\r\n  get triggerCharacters() {\r\n    return [\".\"];\r\n  }\r\n  async provideCompletionItems(model, position, _context, token) {\r\n    const wordInfo = model.getWordUntilPosition(position);\r\n    const wordRange = new monaco_editor_core_exports.Range(\r\n      position.lineNumber,\r\n      wordInfo.startColumn,\r\n      position.lineNumber,\r\n      wordInfo.endColumn\r\n    );\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const info = await worker.getCompletionsAtPosition(resource.toString(), offset);\r\n    if (!info || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const suggestions = info.entries.map((entry) => {\r\n      let range = wordRange;\r\n      if (entry.replacementSpan) {\r\n        const p1 = model.getPositionAt(entry.replacementSpan.start);\r\n        const p2 = model.getPositionAt(entry.replacementSpan.start + entry.replacementSpan.length);\r\n        range = new monaco_editor_core_exports.Range(p1.lineNumber, p1.column, p2.lineNumber, p2.column);\r\n      }\r\n      const tags = [];\r\n      if (entry.kindModifiers !== void 0 && entry.kindModifiers.indexOf(\"deprecated\") !== -1) {\r\n        tags.push(monaco_editor_core_exports.languages.CompletionItemTag.Deprecated);\r\n      }\r\n      return {\r\n        uri: resource,\r\n        position,\r\n        offset,\r\n        range,\r\n        label: entry.name,\r\n        insertText: entry.name,\r\n        sortText: entry.sortText,\r\n        kind: _SuggestAdapter.convertKind(entry.kind),\r\n        tags\r\n      };\r\n    });\r\n    return {\r\n      suggestions\r\n    };\r\n  }\r\n  async resolveCompletionItem(item, token) {\r\n    const myItem = item;\r\n    const resource = myItem.uri;\r\n    const position = myItem.position;\r\n    const offset = myItem.offset;\r\n    const worker = await this._worker(resource);\r\n    const details = await worker.getCompletionEntryDetails(\r\n      resource.toString(),\r\n      offset,\r\n      myItem.label\r\n    );\r\n    if (!details) {\r\n      return myItem;\r\n    }\r\n    return {\r\n      uri: resource,\r\n      position,\r\n      label: details.name,\r\n      kind: _SuggestAdapter.convertKind(details.kind),\r\n      detail: displayPartsToString(details.displayParts),\r\n      documentation: {\r\n        value: _SuggestAdapter.createDocumentationString(details)\r\n      }\r\n    };\r\n  }\r\n  static convertKind(kind) {\r\n    switch (kind) {\r\n      case Kind.primitiveType:\r\n      case Kind.keyword:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Keyword;\r\n      case Kind.variable:\r\n      case Kind.localVariable:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Variable;\r\n      case Kind.memberVariable:\r\n      case Kind.memberGetAccessor:\r\n      case Kind.memberSetAccessor:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Field;\r\n      case Kind.function:\r\n      case Kind.memberFunction:\r\n      case Kind.constructSignature:\r\n      case Kind.callSignature:\r\n      case Kind.indexSignature:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Function;\r\n      case Kind.enum:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Enum;\r\n      case Kind.module:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Module;\r\n      case Kind.class:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Class;\r\n      case Kind.interface:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.Interface;\r\n      case Kind.warning:\r\n        return monaco_editor_core_exports.languages.CompletionItemKind.File;\r\n    }\r\n    return monaco_editor_core_exports.languages.CompletionItemKind.Property;\r\n  }\r\n  static createDocumentationString(details) {\r\n    let documentationString = displayPartsToString(details.documentation);\r\n    if (details.tags) {\r\n      for (const tag of details.tags) {\r\n        documentationString += `\r\n\r\n${tagToString(tag)}`;\r\n      }\r\n    }\r\n    return documentationString;\r\n  }\r\n};\r\nfunction tagToString(tag) {\r\n  let tagLabel = `*@${tag.name}*`;\r\n  if (tag.name === \"param\" && tag.text) {\r\n    const [paramName, ...rest] = tag.text;\r\n    tagLabel += `\\`${paramName.text}\\``;\r\n    if (rest.length > 0)\r\n      tagLabel += ` \\u2014 ${rest.map((r) => r.text).join(\" \")}`;\r\n  } else if (Array.isArray(tag.text)) {\r\n    tagLabel += ` \\u2014 ${tag.text.map((r) => r.text).join(\" \")}`;\r\n  } else if (tag.text) {\r\n    tagLabel += ` \\u2014 ${tag.text}`;\r\n  }\r\n  return tagLabel;\r\n}\r\nvar SignatureHelpAdapter = class _SignatureHelpAdapter extends Adapter {\r\n  constructor() {\r\n    super(...arguments);\r\n    this.signatureHelpTriggerCharacters = [\"(\", \",\"];\r\n  }\r\n  static _toSignatureHelpTriggerReason(context) {\r\n    switch (context.triggerKind) {\r\n      case monaco_editor_core_exports.languages.SignatureHelpTriggerKind.TriggerCharacter:\r\n        if (context.triggerCharacter) {\r\n          if (context.isRetrigger) {\r\n            return { kind: \"retrigger\", triggerCharacter: context.triggerCharacter };\r\n          } else {\r\n            return { kind: \"characterTyped\", triggerCharacter: context.triggerCharacter };\r\n          }\r\n        } else {\r\n          return { kind: \"invoked\" };\r\n        }\r\n      case monaco_editor_core_exports.languages.SignatureHelpTriggerKind.ContentChange:\r\n        return context.isRetrigger ? { kind: \"retrigger\" } : { kind: \"invoked\" };\r\n      case monaco_editor_core_exports.languages.SignatureHelpTriggerKind.Invoke:\r\n      default:\r\n        return { kind: \"invoked\" };\r\n    }\r\n  }\r\n  async provideSignatureHelp(model, position, token, context) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const info = await worker.getSignatureHelpItems(resource.toString(), offset, {\r\n      triggerReason: _SignatureHelpAdapter._toSignatureHelpTriggerReason(context)\r\n    });\r\n    if (!info || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const ret = {\r\n      activeSignature: info.selectedItemIndex,\r\n      activeParameter: info.argumentIndex,\r\n      signatures: []\r\n    };\r\n    info.items.forEach((item) => {\r\n      const signature = {\r\n        label: \"\",\r\n        parameters: []\r\n      };\r\n      signature.documentation = {\r\n        value: displayPartsToString(item.documentation)\r\n      };\r\n      signature.label += displayPartsToString(item.prefixDisplayParts);\r\n      item.parameters.forEach((p, i, a) => {\r\n        const label = displayPartsToString(p.displayParts);\r\n        const parameter = {\r\n          label,\r\n          documentation: {\r\n            value: displayPartsToString(p.documentation)\r\n          }\r\n        };\r\n        signature.label += label;\r\n        signature.parameters.push(parameter);\r\n        if (i < a.length - 1) {\r\n          signature.label += displayPartsToString(item.separatorDisplayParts);\r\n        }\r\n      });\r\n      signature.label += displayPartsToString(item.suffixDisplayParts);\r\n      ret.signatures.push(signature);\r\n    });\r\n    return {\r\n      value: ret,\r\n      dispose() {\r\n      }\r\n    };\r\n  }\r\n};\r\nvar QuickInfoAdapter = class extends Adapter {\r\n  async provideHover(model, position, token) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const info = await worker.getQuickInfoAtPosition(resource.toString(), offset);\r\n    if (!info || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const documentation = displayPartsToString(info.documentation);\r\n    const tags = info.tags ? info.tags.map((tag) => tagToString(tag)).join(\"  \\n\\n\") : \"\";\r\n    const contents = displayPartsToString(info.displayParts);\r\n    return {\r\n      range: this._textSpanToRange(model, info.textSpan),\r\n      contents: [\r\n        {\r\n          value: \"```typescript\\n\" + contents + \"\\n```\\n\"\r\n        },\r\n        {\r\n          value: documentation + (tags ? \"\\n\\n\" + tags : \"\")\r\n        }\r\n      ]\r\n    };\r\n  }\r\n};\r\nvar DocumentHighlightAdapter = class extends Adapter {\r\n  async provideDocumentHighlights(model, position, token) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const entries = await worker.getDocumentHighlights(resource.toString(), offset, [\r\n      resource.toString()\r\n    ]);\r\n    if (!entries || model.isDisposed()) {\r\n      return;\r\n    }\r\n    return entries.flatMap((entry) => {\r\n      return entry.highlightSpans.map((highlightSpans) => {\r\n        return {\r\n          range: this._textSpanToRange(model, highlightSpans.textSpan),\r\n          kind: highlightSpans.kind === \"writtenReference\" ? monaco_editor_core_exports.languages.DocumentHighlightKind.Write : monaco_editor_core_exports.languages.DocumentHighlightKind.Text\r\n        };\r\n      });\r\n    });\r\n  }\r\n};\r\nvar DefinitionAdapter = class extends Adapter {\r\n  constructor(_libFiles, worker) {\r\n    super(worker);\r\n    this._libFiles = _libFiles;\r\n  }\r\n  async provideDefinition(model, position, token) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const entries = await worker.getDefinitionAtPosition(resource.toString(), offset);\r\n    if (!entries || model.isDisposed()) {\r\n      return;\r\n    }\r\n    await this._libFiles.fetchLibFilesIfNecessary(\r\n      entries.map((entry) => monaco_editor_core_exports.Uri.parse(entry.fileName))\r\n    );\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const result = [];\r\n    for (let entry of entries) {\r\n      const refModel = this._libFiles.getOrCreateModel(entry.fileName);\r\n      if (refModel) {\r\n        result.push({\r\n          uri: refModel.uri,\r\n          range: this._textSpanToRange(refModel, entry.textSpan)\r\n        });\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n};\r\nvar ReferenceAdapter = class extends Adapter {\r\n  constructor(_libFiles, worker) {\r\n    super(worker);\r\n    this._libFiles = _libFiles;\r\n  }\r\n  async provideReferences(model, position, context, token) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const entries = await worker.getReferencesAtPosition(resource.toString(), offset);\r\n    if (!entries || model.isDisposed()) {\r\n      return;\r\n    }\r\n    await this._libFiles.fetchLibFilesIfNecessary(\r\n      entries.map((entry) => monaco_editor_core_exports.Uri.parse(entry.fileName))\r\n    );\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const result = [];\r\n    for (let entry of entries) {\r\n      const refModel = this._libFiles.getOrCreateModel(entry.fileName);\r\n      if (refModel) {\r\n        result.push({\r\n          uri: refModel.uri,\r\n          range: this._textSpanToRange(refModel, entry.textSpan)\r\n        });\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n};\r\nvar OutlineAdapter = class extends Adapter {\r\n  async provideDocumentSymbols(model, token) {\r\n    const resource = model.uri;\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const root = await worker.getNavigationTree(resource.toString());\r\n    if (!root || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const convert = (item, containerLabel) => {\r\n      const result2 = {\r\n        name: item.text,\r\n        detail: \"\",\r\n        kind: outlineTypeTable[item.kind] || monaco_editor_core_exports.languages.SymbolKind.Variable,\r\n        range: this._textSpanToRange(model, item.spans[0]),\r\n        selectionRange: this._textSpanToRange(model, item.spans[0]),\r\n        tags: [],\r\n        children: item.childItems?.map((child) => convert(child, item.text)),\r\n        containerName: containerLabel\r\n      };\r\n      return result2;\r\n    };\r\n    const result = root.childItems ? root.childItems.map((item) => convert(item)) : [];\r\n    return result;\r\n  }\r\n};\r\nvar Kind = class {\r\n  static {\r\n    this.unknown = \"\";\r\n  }\r\n  static {\r\n    this.keyword = \"keyword\";\r\n  }\r\n  static {\r\n    this.script = \"script\";\r\n  }\r\n  static {\r\n    this.module = \"module\";\r\n  }\r\n  static {\r\n    this.class = \"class\";\r\n  }\r\n  static {\r\n    this.interface = \"interface\";\r\n  }\r\n  static {\r\n    this.type = \"type\";\r\n  }\r\n  static {\r\n    this.enum = \"enum\";\r\n  }\r\n  static {\r\n    this.variable = \"var\";\r\n  }\r\n  static {\r\n    this.localVariable = \"local var\";\r\n  }\r\n  static {\r\n    this.function = \"function\";\r\n  }\r\n  static {\r\n    this.localFunction = \"local function\";\r\n  }\r\n  static {\r\n    this.memberFunction = \"method\";\r\n  }\r\n  static {\r\n    this.memberGetAccessor = \"getter\";\r\n  }\r\n  static {\r\n    this.memberSetAccessor = \"setter\";\r\n  }\r\n  static {\r\n    this.memberVariable = \"property\";\r\n  }\r\n  static {\r\n    this.constructorImplementation = \"constructor\";\r\n  }\r\n  static {\r\n    this.callSignature = \"call\";\r\n  }\r\n  static {\r\n    this.indexSignature = \"index\";\r\n  }\r\n  static {\r\n    this.constructSignature = \"construct\";\r\n  }\r\n  static {\r\n    this.parameter = \"parameter\";\r\n  }\r\n  static {\r\n    this.typeParameter = \"type parameter\";\r\n  }\r\n  static {\r\n    this.primitiveType = \"primitive type\";\r\n  }\r\n  static {\r\n    this.label = \"label\";\r\n  }\r\n  static {\r\n    this.alias = \"alias\";\r\n  }\r\n  static {\r\n    this.const = \"const\";\r\n  }\r\n  static {\r\n    this.let = \"let\";\r\n  }\r\n  static {\r\n    this.warning = \"warning\";\r\n  }\r\n};\r\nvar outlineTypeTable = /* @__PURE__ */ Object.create(null);\r\noutlineTypeTable[Kind.module] = monaco_editor_core_exports.languages.SymbolKind.Module;\r\noutlineTypeTable[Kind.class] = monaco_editor_core_exports.languages.SymbolKind.Class;\r\noutlineTypeTable[Kind.enum] = monaco_editor_core_exports.languages.SymbolKind.Enum;\r\noutlineTypeTable[Kind.interface] = monaco_editor_core_exports.languages.SymbolKind.Interface;\r\noutlineTypeTable[Kind.memberFunction] = monaco_editor_core_exports.languages.SymbolKind.Method;\r\noutlineTypeTable[Kind.memberVariable] = monaco_editor_core_exports.languages.SymbolKind.Property;\r\noutlineTypeTable[Kind.memberGetAccessor] = monaco_editor_core_exports.languages.SymbolKind.Property;\r\noutlineTypeTable[Kind.memberSetAccessor] = monaco_editor_core_exports.languages.SymbolKind.Property;\r\noutlineTypeTable[Kind.variable] = monaco_editor_core_exports.languages.SymbolKind.Variable;\r\noutlineTypeTable[Kind.const] = monaco_editor_core_exports.languages.SymbolKind.Variable;\r\noutlineTypeTable[Kind.localVariable] = monaco_editor_core_exports.languages.SymbolKind.Variable;\r\noutlineTypeTable[Kind.variable] = monaco_editor_core_exports.languages.SymbolKind.Variable;\r\noutlineTypeTable[Kind.function] = monaco_editor_core_exports.languages.SymbolKind.Function;\r\noutlineTypeTable[Kind.localFunction] = monaco_editor_core_exports.languages.SymbolKind.Function;\r\nvar FormatHelper = class extends Adapter {\r\n  static _convertOptions(options) {\r\n    return {\r\n      ConvertTabsToSpaces: options.insertSpaces,\r\n      TabSize: options.tabSize,\r\n      IndentSize: options.tabSize,\r\n      IndentStyle: 2 /* Smart */,\r\n      NewLineCharacter: \"\\n\",\r\n      InsertSpaceAfterCommaDelimiter: true,\r\n      InsertSpaceAfterSemicolonInForStatements: true,\r\n      InsertSpaceBeforeAndAfterBinaryOperators: true,\r\n      InsertSpaceAfterKeywordsInControlFlowStatements: true,\r\n      InsertSpaceAfterFunctionKeywordForAnonymousFunctions: true,\r\n      InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis: false,\r\n      InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets: false,\r\n      InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces: false,\r\n      PlaceOpenBraceOnNewLineForControlBlocks: false,\r\n      PlaceOpenBraceOnNewLineForFunctions: false\r\n    };\r\n  }\r\n  _convertTextChanges(model, change) {\r\n    return {\r\n      text: change.newText,\r\n      range: this._textSpanToRange(model, change.span)\r\n    };\r\n  }\r\n};\r\nvar FormatAdapter = class extends FormatHelper {\r\n  constructor() {\r\n    super(...arguments);\r\n    this.canFormatMultipleRanges = false;\r\n  }\r\n  async provideDocumentRangeFormattingEdits(model, range, options, token) {\r\n    const resource = model.uri;\r\n    const startOffset = model.getOffsetAt({\r\n      lineNumber: range.startLineNumber,\r\n      column: range.startColumn\r\n    });\r\n    const endOffset = model.getOffsetAt({\r\n      lineNumber: range.endLineNumber,\r\n      column: range.endColumn\r\n    });\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const edits = await worker.getFormattingEditsForRange(\r\n      resource.toString(),\r\n      startOffset,\r\n      endOffset,\r\n      FormatHelper._convertOptions(options)\r\n    );\r\n    if (!edits || model.isDisposed()) {\r\n      return;\r\n    }\r\n    return edits.map((edit) => this._convertTextChanges(model, edit));\r\n  }\r\n};\r\nvar FormatOnTypeAdapter = class extends FormatHelper {\r\n  get autoFormatTriggerCharacters() {\r\n    return [\";\", \"}\", \"\\n\"];\r\n  }\r\n  async provideOnTypeFormattingEdits(model, position, ch, options, token) {\r\n    const resource = model.uri;\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const edits = await worker.getFormattingEditsAfterKeystroke(\r\n      resource.toString(),\r\n      offset,\r\n      ch,\r\n      FormatHelper._convertOptions(options)\r\n    );\r\n    if (!edits || model.isDisposed()) {\r\n      return;\r\n    }\r\n    return edits.map((edit) => this._convertTextChanges(model, edit));\r\n  }\r\n};\r\nvar CodeActionAdaptor = class extends FormatHelper {\r\n  async provideCodeActions(model, range, context, token) {\r\n    const resource = model.uri;\r\n    const start = model.getOffsetAt({\r\n      lineNumber: range.startLineNumber,\r\n      column: range.startColumn\r\n    });\r\n    const end = model.getOffsetAt({\r\n      lineNumber: range.endLineNumber,\r\n      column: range.endColumn\r\n    });\r\n    const formatOptions = FormatHelper._convertOptions(model.getOptions());\r\n    const errorCodes = context.markers.filter((m) => m.code).map((m) => m.code).map(Number);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const codeFixes = await worker.getCodeFixesAtPosition(\r\n      resource.toString(),\r\n      start,\r\n      end,\r\n      errorCodes,\r\n      formatOptions\r\n    );\r\n    if (!codeFixes || model.isDisposed()) {\r\n      return { actions: [], dispose: () => {\r\n      } };\r\n    }\r\n    const actions = codeFixes.filter((fix) => {\r\n      return fix.changes.filter((change) => change.isNewFile).length === 0;\r\n    }).map((fix) => {\r\n      return this._tsCodeFixActionToMonacoCodeAction(model, context, fix);\r\n    });\r\n    return {\r\n      actions,\r\n      dispose: () => {\r\n      }\r\n    };\r\n  }\r\n  _tsCodeFixActionToMonacoCodeAction(model, context, codeFix) {\r\n    const edits = [];\r\n    for (const change of codeFix.changes) {\r\n      for (const textChange of change.textChanges) {\r\n        edits.push({\r\n          resource: model.uri,\r\n          versionId: void 0,\r\n          textEdit: {\r\n            range: this._textSpanToRange(model, textChange.span),\r\n            text: textChange.newText\r\n          }\r\n        });\r\n      }\r\n    }\r\n    const action = {\r\n      title: codeFix.description,\r\n      edit: { edits },\r\n      diagnostics: context.markers,\r\n      kind: \"quickfix\"\r\n    };\r\n    return action;\r\n  }\r\n};\r\nvar RenameAdapter = class extends Adapter {\r\n  constructor(_libFiles, worker) {\r\n    super(worker);\r\n    this._libFiles = _libFiles;\r\n  }\r\n  async provideRenameEdits(model, position, newName, token) {\r\n    const resource = model.uri;\r\n    const fileName = resource.toString();\r\n    const offset = model.getOffsetAt(position);\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return;\r\n    }\r\n    const renameInfo = await worker.getRenameInfo(fileName, offset, {\r\n      allowRenameOfImportPath: false\r\n    });\r\n    if (renameInfo.canRename === false) {\r\n      return {\r\n        edits: [],\r\n        rejectReason: renameInfo.localizedErrorMessage\r\n      };\r\n    }\r\n    if (renameInfo.fileToRename !== void 0) {\r\n      throw new Error(\"Renaming files is not supported.\");\r\n    }\r\n    const renameLocations = await worker.findRenameLocations(\r\n      fileName,\r\n      offset,\r\n      /*strings*/\r\n      false,\r\n      /*comments*/\r\n      false,\r\n      /*prefixAndSuffix*/\r\n      false\r\n    );\r\n    if (!renameLocations || model.isDisposed()) {\r\n      return;\r\n    }\r\n    const edits = [];\r\n    for (const renameLocation of renameLocations) {\r\n      const model2 = this._libFiles.getOrCreateModel(renameLocation.fileName);\r\n      if (model2) {\r\n        edits.push({\r\n          resource: model2.uri,\r\n          versionId: void 0,\r\n          textEdit: {\r\n            range: this._textSpanToRange(model2, renameLocation.textSpan),\r\n            text: newName\r\n          }\r\n        });\r\n      } else {\r\n        throw new Error(`Unknown file ${renameLocation.fileName}.`);\r\n      }\r\n    }\r\n    return { edits };\r\n  }\r\n};\r\nvar InlayHintsAdapter = class extends Adapter {\r\n  async provideInlayHints(model, range, token) {\r\n    const resource = model.uri;\r\n    const fileName = resource.toString();\r\n    const start = model.getOffsetAt({\r\n      lineNumber: range.startLineNumber,\r\n      column: range.startColumn\r\n    });\r\n    const end = model.getOffsetAt({\r\n      lineNumber: range.endLineNumber,\r\n      column: range.endColumn\r\n    });\r\n    const worker = await this._worker(resource);\r\n    if (model.isDisposed()) {\r\n      return null;\r\n    }\r\n    const tsHints = await worker.provideInlayHints(fileName, start, end);\r\n    const hints = tsHints.map((hint) => {\r\n      return {\r\n        ...hint,\r\n        label: hint.text,\r\n        position: model.getPositionAt(hint.position),\r\n        kind: this._convertHintKind(hint.kind)\r\n      };\r\n    });\r\n    return { hints, dispose: () => {\r\n    } };\r\n  }\r\n  _convertHintKind(kind) {\r\n    switch (kind) {\r\n      case \"Parameter\":\r\n        return monaco_editor_core_exports.languages.InlayHintKind.Parameter;\r\n      case \"Type\":\r\n        return monaco_editor_core_exports.languages.InlayHintKind.Type;\r\n      default:\r\n        return monaco_editor_core_exports.languages.InlayHintKind.Type;\r\n    }\r\n  }\r\n};\r\n\r\n// src/language/typescript/tsMode.ts\r\nvar javaScriptWorker;\r\nvar typeScriptWorker;\r\nfunction setupTypeScript(defaults) {\r\n  typeScriptWorker = setupMode(defaults, \"typescript\");\r\n}\r\nfunction setupJavaScript(defaults) {\r\n  javaScriptWorker = setupMode(defaults, \"javascript\");\r\n}\r\nfunction getJavaScriptWorker() {\r\n  return new Promise((resolve, reject) => {\r\n    if (!javaScriptWorker) {\r\n      return reject(\"JavaScript not registered!\");\r\n    }\r\n    resolve(javaScriptWorker);\r\n  });\r\n}\r\nfunction getTypeScriptWorker() {\r\n  return new Promise((resolve, reject) => {\r\n    if (!typeScriptWorker) {\r\n      return reject(\"TypeScript not registered!\");\r\n    }\r\n    resolve(typeScriptWorker);\r\n  });\r\n}\r\nfunction setupMode(defaults, modeId) {\r\n  const disposables = [];\r\n  const providers = [];\r\n  const client = new WorkerManager(modeId, defaults);\r\n  disposables.push(client);\r\n  const worker = (...uris) => {\r\n    return client.getLanguageServiceWorker(...uris);\r\n  };\r\n  const libFiles = new LibFiles(worker);\r\n  function registerProviders() {\r\n    const { modeConfiguration } = defaults;\r\n    disposeAll(providers);\r\n    if (modeConfiguration.completionItems) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerCompletionItemProvider(\r\n          modeId,\r\n          new SuggestAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.signatureHelp) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerSignatureHelpProvider(\r\n          modeId,\r\n          new SignatureHelpAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.hovers) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerHoverProvider(modeId, new QuickInfoAdapter(worker))\r\n      );\r\n    }\r\n    if (modeConfiguration.documentHighlights) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerDocumentHighlightProvider(\r\n          modeId,\r\n          new DocumentHighlightAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.definitions) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerDefinitionProvider(\r\n          modeId,\r\n          new DefinitionAdapter(libFiles, worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.references) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerReferenceProvider(\r\n          modeId,\r\n          new ReferenceAdapter(libFiles, worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.documentSymbols) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerDocumentSymbolProvider(\r\n          modeId,\r\n          new OutlineAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.rename) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerRenameProvider(\r\n          modeId,\r\n          new RenameAdapter(libFiles, worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.documentRangeFormattingEdits) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerDocumentRangeFormattingEditProvider(\r\n          modeId,\r\n          new FormatAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.onTypeFormattingEdits) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerOnTypeFormattingEditProvider(\r\n          modeId,\r\n          new FormatOnTypeAdapter(worker)\r\n        )\r\n      );\r\n    }\r\n    if (modeConfiguration.codeActions) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerCodeActionProvider(modeId, new CodeActionAdaptor(worker))\r\n      );\r\n    }\r\n    if (modeConfiguration.inlayHints) {\r\n      providers.push(\r\n        monaco_editor_core_exports.languages.registerInlayHintsProvider(modeId, new InlayHintsAdapter(worker))\r\n      );\r\n    }\r\n    if (modeConfiguration.diagnostics) {\r\n      providers.push(new DiagnosticsAdapter(libFiles, defaults, modeId, worker));\r\n    }\r\n  }\r\n  registerProviders();\r\n  disposables.push(asDisposable(providers));\r\n  return worker;\r\n}\r\nfunction asDisposable(disposables) {\r\n  return { dispose: () => disposeAll(disposables) };\r\n}\r\nfunction disposeAll(disposables) {\r\n  while (disposables.length) {\r\n    disposables.pop().dispose();\r\n  }\r\n}\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvbGFuZ3VhZ2UvdHlwZXNjcmlwdC90c01vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw0RkFBNEY7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsa0RBQXVCO0FBQ1E7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR2tDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbURBQW1EO0FBQzdELFVBQVUsK0NBQStDO0FBQ3pELGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQWtCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxnQkFBZ0IsY0FBYztBQUM5QjtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG9FQUFvRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtREFBbUQ7QUFDL0QsWUFBWSwrQ0FBK0M7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxtREFBbUQ7QUFDakUsY0FBYywrQ0FBK0M7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxpQkFBaUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFNBQVM7QUFDL0I7QUFDQTtBQUNBLHFCQUFxQixlQUFlO0FBQ3BDO0FBQ0EsNkJBQTZCLGtDQUFrQztBQUMvRCxJQUFJO0FBQ0osMkJBQTJCLHNDQUFzQztBQUNqRSxJQUFJO0FBQ0osMkJBQTJCLFNBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsWUFBWTtBQUNaLHFCQUFxQjtBQUNyQjtBQUNBLFVBQVU7QUFDVixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLHVDQUF1QyxvQkFBb0IsSUFBSTtBQUMvRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLEtBQUs7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsUUFBUTtBQUNSLHdDQUF3Qyx3QkFBd0I7QUFDaEU7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvQkFBb0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeUJFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2xhbmd1YWdlL3R5cGVzY3JpcHQvdHNNb2RlLmpzP2UzMjgiXSwic291cmNlc0NvbnRlbnQiOlsiLyohLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIFZlcnNpb246IDAuNTAuMChjMzIxZDBmYmVjYjUwYWI4YTUzNjVmYTE5NjU0NzZiMGFlNjNmYzg3KVxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcclxuICogaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9tb25hY28tZWRpdG9yL2Jsb2IvbWFpbi9MSUNFTlNFLnR4dFxyXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuXHJcbnZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XHJcbnZhciBfX2dldE93blByb3BEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcclxudmFyIF9fZ2V0T3duUHJvcE5hbWVzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7XHJcbnZhciBfX2hhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xyXG52YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4ge1xyXG4gIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBmcm9tID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgIGZvciAobGV0IGtleSBvZiBfX2dldE93blByb3BOYW1lcyhmcm9tKSlcclxuICAgICAgaWYgKCFfX2hhc093blByb3AuY2FsbCh0bywga2V5KSAmJiBrZXkgIT09IGV4Y2VwdClcclxuICAgICAgICBfX2RlZlByb3AodG8sIGtleSwgeyBnZXQ6ICgpID0+IGZyb21ba2V5XSwgZW51bWVyYWJsZTogIShkZXNjID0gX19nZXRPd25Qcm9wRGVzYyhmcm9tLCBrZXkpKSB8fCBkZXNjLmVudW1lcmFibGUgfSk7XHJcbiAgfVxyXG4gIHJldHVybiB0bztcclxufTtcclxudmFyIF9fcmVFeHBvcnQgPSAodGFyZ2V0LCBtb2QsIHNlY29uZFRhcmdldCkgPT4gKF9fY29weVByb3BzKHRhcmdldCwgbW9kLCBcImRlZmF1bHRcIiksIHNlY29uZFRhcmdldCAmJiBfX2NvcHlQcm9wcyhzZWNvbmRUYXJnZXQsIG1vZCwgXCJkZWZhdWx0XCIpKTtcclxuXHJcbi8vIHNyYy9maWxsZXJzL21vbmFjby1lZGl0b3ItY29yZS50c1xyXG52YXIgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMgPSB7fTtcclxuX19yZUV4cG9ydChtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cywgbW9uYWNvX2VkaXRvcl9jb3JlX3N0YXIpO1xyXG5pbXBvcnQgKiBhcyBtb25hY29fZWRpdG9yX2NvcmVfc3RhciBmcm9tIFwiLi4vLi4vZWRpdG9yL2VkaXRvci5hcGkuanNcIjtcclxuXHJcbi8vIHNyYy9sYW5ndWFnZS90eXBlc2NyaXB0L3dvcmtlck1hbmFnZXIudHNcclxudmFyIFdvcmtlck1hbmFnZXIgPSBjbGFzcyB7XHJcbiAgY29uc3RydWN0b3IoX21vZGVJZCwgX2RlZmF1bHRzKSB7XHJcbiAgICB0aGlzLl9tb2RlSWQgPSBfbW9kZUlkO1xyXG4gICAgdGhpcy5fZGVmYXVsdHMgPSBfZGVmYXVsdHM7XHJcbiAgICB0aGlzLl93b3JrZXIgPSBudWxsO1xyXG4gICAgdGhpcy5fY2xpZW50ID0gbnVsbDtcclxuICAgIHRoaXMuX2NvbmZpZ0NoYW5nZUxpc3RlbmVyID0gdGhpcy5fZGVmYXVsdHMub25EaWRDaGFuZ2UoKCkgPT4gdGhpcy5fc3RvcFdvcmtlcigpKTtcclxuICAgIHRoaXMuX3VwZGF0ZUV4dHJhTGlic1Rva2VuID0gMDtcclxuICAgIHRoaXMuX2V4dHJhTGlic0NoYW5nZUxpc3RlbmVyID0gdGhpcy5fZGVmYXVsdHMub25EaWRFeHRyYUxpYnNDaGFuZ2UoXHJcbiAgICAgICgpID0+IHRoaXMuX3VwZGF0ZUV4dHJhTGlicygpXHJcbiAgICApO1xyXG4gIH1cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5fY29uZmlnQ2hhbmdlTGlzdGVuZXIuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5fZXh0cmFMaWJzQ2hhbmdlTGlzdGVuZXIuZGlzcG9zZSgpO1xyXG4gICAgdGhpcy5fc3RvcFdvcmtlcigpO1xyXG4gIH1cclxuICBfc3RvcFdvcmtlcigpIHtcclxuICAgIGlmICh0aGlzLl93b3JrZXIpIHtcclxuICAgICAgdGhpcy5fd29ya2VyLmRpc3Bvc2UoKTtcclxuICAgICAgdGhpcy5fd29ya2VyID0gbnVsbDtcclxuICAgIH1cclxuICAgIHRoaXMuX2NsaWVudCA9IG51bGw7XHJcbiAgfVxyXG4gIGFzeW5jIF91cGRhdGVFeHRyYUxpYnMoKSB7XHJcbiAgICBpZiAoIXRoaXMuX3dvcmtlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBteVRva2VuID0gKyt0aGlzLl91cGRhdGVFeHRyYUxpYnNUb2tlbjtcclxuICAgIGNvbnN0IHByb3h5ID0gYXdhaXQgdGhpcy5fd29ya2VyLmdldFByb3h5KCk7XHJcbiAgICBpZiAodGhpcy5fdXBkYXRlRXh0cmFMaWJzVG9rZW4gIT09IG15VG9rZW4pIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcHJveHkudXBkYXRlRXh0cmFMaWJzKHRoaXMuX2RlZmF1bHRzLmdldEV4dHJhTGlicygpKTtcclxuICB9XHJcbiAgX2dldENsaWVudCgpIHtcclxuICAgIGlmICghdGhpcy5fY2xpZW50KSB7XHJcbiAgICAgIHRoaXMuX2NsaWVudCA9IChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fd29ya2VyID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmNyZWF0ZVdlYldvcmtlcih7XHJcbiAgICAgICAgICAvLyBtb2R1bGUgdGhhdCBleHBvcnRzIHRoZSBjcmVhdGUoKSBtZXRob2QgYW5kIHJldHVybnMgYSBgVHlwZVNjcmlwdFdvcmtlcmAgaW5zdGFuY2VcclxuICAgICAgICAgIG1vZHVsZUlkOiBcInZzL2xhbmd1YWdlL3R5cGVzY3JpcHQvdHNXb3JrZXJcIixcclxuICAgICAgICAgIGxhYmVsOiB0aGlzLl9tb2RlSWQsXHJcbiAgICAgICAgICBrZWVwSWRsZU1vZGVsczogdHJ1ZSxcclxuICAgICAgICAgIC8vIHBhc3NlZCBpbiB0byB0aGUgY3JlYXRlKCkgbWV0aG9kXHJcbiAgICAgICAgICBjcmVhdGVEYXRhOiB7XHJcbiAgICAgICAgICAgIGNvbXBpbGVyT3B0aW9uczogdGhpcy5fZGVmYXVsdHMuZ2V0Q29tcGlsZXJPcHRpb25zKCksXHJcbiAgICAgICAgICAgIGV4dHJhTGliczogdGhpcy5fZGVmYXVsdHMuZ2V0RXh0cmFMaWJzKCksXHJcbiAgICAgICAgICAgIGN1c3RvbVdvcmtlclBhdGg6IHRoaXMuX2RlZmF1bHRzLndvcmtlck9wdGlvbnMuY3VzdG9tV29ya2VyUGF0aCxcclxuICAgICAgICAgICAgaW5sYXlIaW50c09wdGlvbnM6IHRoaXMuX2RlZmF1bHRzLmlubGF5SGludHNPcHRpb25zXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RlZmF1bHRzLmdldEVhZ2VyTW9kZWxTeW5jKCkpIHtcclxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLl93b3JrZXIud2l0aFN5bmNlZFJlc291cmNlcyhcclxuICAgICAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmdldE1vZGVscygpLmZpbHRlcigobW9kZWwpID0+IG1vZGVsLmdldExhbmd1YWdlSWQoKSA9PT0gdGhpcy5fbW9kZUlkKS5tYXAoKG1vZGVsKSA9PiBtb2RlbC51cmkpXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fd29ya2VyLmdldFByb3h5KCk7XHJcbiAgICAgIH0pKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5fY2xpZW50O1xyXG4gIH1cclxuICBhc3luYyBnZXRMYW5ndWFnZVNlcnZpY2VXb3JrZXIoLi4ucmVzb3VyY2VzKSB7XHJcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCB0aGlzLl9nZXRDbGllbnQoKTtcclxuICAgIGlmICh0aGlzLl93b3JrZXIpIHtcclxuICAgICAgYXdhaXQgdGhpcy5fd29ya2VyLndpdGhTeW5jZWRSZXNvdXJjZXMocmVzb3VyY2VzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjbGllbnQ7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gc3JjL2xhbmd1YWdlL3R5cGVzY3JpcHQvbGFuZ3VhZ2VGZWF0dXJlcy50c1xyXG5pbXBvcnQge1xyXG4gIHR5cGVzY3JpcHREZWZhdWx0c1xyXG59IGZyb20gXCIuL21vbmFjby5jb250cmlidXRpb24uanNcIjtcclxuXHJcbi8vIHNyYy9sYW5ndWFnZS90eXBlc2NyaXB0L2xpYi9saWIuaW5kZXgudHNcclxudmFyIGxpYkZpbGVTZXQgPSB7fTtcclxubGliRmlsZVNldFtcImxpYi5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5kZWNvcmF0b3JzLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmRlY29yYXRvcnMubGVnYWN5LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmRvbS5hc3luY2l0ZXJhYmxlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmRvbS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5kb20uaXRlcmFibGUuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE1LmNvbGxlY3Rpb24uZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE1LmNvcmUuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE1LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNS5nZW5lcmF0b3IuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE1Lml0ZXJhYmxlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNS5wcm9taXNlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNS5wcm94eS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTUucmVmbGVjdC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTUuc3ltYm9sLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNS5zeW1ib2wud2VsbGtub3duLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNi5hcnJheS5pbmNsdWRlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNi5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTYuZnVsbC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTYuaW50bC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTcuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE3LmRhdGUuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE3LmZ1bGwuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE3LmludGwuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE3Lm9iamVjdC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTcuc2hhcmVkbWVtb3J5LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxNy5zdHJpbmcuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE3LnR5cGVkYXJyYXlzLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxOC5hc3luY2dlbmVyYXRvci5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTguYXN5bmNpdGVyYWJsZS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTguZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE4LmZ1bGwuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE4LmludGwuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE4LnByb21pc2UuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE4LnJlZ2V4cC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTkuYXJyYXkuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE5LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxOS5mdWxsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxOS5pbnRsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAxOS5vYmplY3QuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDE5LnN0cmluZy5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMTkuc3ltYm9sLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5iaWdpbnQuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIwLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5kYXRlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5mdWxsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5pbnRsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5udW1iZXIuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIwLnByb21pc2UuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIwLnNoYXJlZG1lbW9yeS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjAuc3RyaW5nLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMC5zeW1ib2wud2VsbGtub3duLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjEuZnVsbC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjEuaW50bC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjEucHJvbWlzZS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjEuc3RyaW5nLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMS53ZWFrcmVmLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMi5hcnJheS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjIuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIyLmVycm9yLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMi5mdWxsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMi5pbnRsLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMi5vYmplY3QuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIyLnJlZ2V4cC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjIuc2hhcmVkbWVtb3J5LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMi5zdHJpbmcuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXMyMDIzLmFycmF5LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMy5jb2xsZWN0aW9uLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzMjAyMy5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczIwMjMuZnVsbC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lczUuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIuZXM2LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzbmV4dC5jb2xsZWN0aW9uLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzbmV4dC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lc25leHQuZGVjb3JhdG9ycy5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lc25leHQuZGlzcG9zYWJsZS5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lc25leHQuZnVsbC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lc25leHQuaW50bC5kLnRzXCJdID0gdHJ1ZTtcclxubGliRmlsZVNldFtcImxpYi5lc25leHQub2JqZWN0LmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLmVzbmV4dC5wcm9taXNlLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLnNjcmlwdGhvc3QuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIud2Vid29ya2VyLmFzeW5jaXRlcmFibGUuZC50c1wiXSA9IHRydWU7XHJcbmxpYkZpbGVTZXRbXCJsaWIud2Vid29ya2VyLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLndlYndvcmtlci5pbXBvcnRzY3JpcHRzLmQudHNcIl0gPSB0cnVlO1xyXG5saWJGaWxlU2V0W1wibGliLndlYndvcmtlci5pdGVyYWJsZS5kLnRzXCJdID0gdHJ1ZTtcclxuXHJcbi8vIHNyYy9sYW5ndWFnZS90eXBlc2NyaXB0L2xhbmd1YWdlRmVhdHVyZXMudHNcclxuZnVuY3Rpb24gZmxhdHRlbkRpYWdub3N0aWNNZXNzYWdlVGV4dChkaWFnLCBuZXdMaW5lLCBpbmRlbnQgPSAwKSB7XHJcbiAgaWYgKHR5cGVvZiBkaWFnID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICByZXR1cm4gZGlhZztcclxuICB9IGVsc2UgaWYgKGRpYWcgPT09IHZvaWQgMCkge1xyXG4gICAgcmV0dXJuIFwiXCI7XHJcbiAgfVxyXG4gIGxldCByZXN1bHQgPSBcIlwiO1xyXG4gIGlmIChpbmRlbnQpIHtcclxuICAgIHJlc3VsdCArPSBuZXdMaW5lO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRlbnQ7IGkrKykge1xyXG4gICAgICByZXN1bHQgKz0gXCIgIFwiO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXN1bHQgKz0gZGlhZy5tZXNzYWdlVGV4dDtcclxuICBpbmRlbnQrKztcclxuICBpZiAoZGlhZy5uZXh0KSB7XHJcbiAgICBmb3IgKGNvbnN0IGtpZCBvZiBkaWFnLm5leHQpIHtcclxuICAgICAgcmVzdWx0ICs9IGZsYXR0ZW5EaWFnbm9zdGljTWVzc2FnZVRleHQoa2lkLCBuZXdMaW5lLCBpbmRlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbmZ1bmN0aW9uIGRpc3BsYXlQYXJ0c1RvU3RyaW5nKGRpc3BsYXlQYXJ0cykge1xyXG4gIGlmIChkaXNwbGF5UGFydHMpIHtcclxuICAgIHJldHVybiBkaXNwbGF5UGFydHMubWFwKChkaXNwbGF5UGFydCkgPT4gZGlzcGxheVBhcnQudGV4dCkuam9pbihcIlwiKTtcclxuICB9XHJcbiAgcmV0dXJuIFwiXCI7XHJcbn1cclxudmFyIEFkYXB0ZXIgPSBjbGFzcyB7XHJcbiAgY29uc3RydWN0b3IoX3dvcmtlcikge1xyXG4gICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcclxuICB9XHJcbiAgLy8gcHJvdGVjdGVkIF9wb3NpdGlvblRvT2Zmc2V0KG1vZGVsOiBlZGl0b3IuSVRleHRNb2RlbCwgcG9zaXRpb246IG1vbmFjby5JUG9zaXRpb24pOiBudW1iZXIge1xyXG4gIC8vIFx0cmV0dXJuIG1vZGVsLmdldE9mZnNldEF0KHBvc2l0aW9uKTtcclxuICAvLyB9XHJcbiAgLy8gcHJvdGVjdGVkIF9vZmZzZXRUb1Bvc2l0aW9uKG1vZGVsOiBlZGl0b3IuSVRleHRNb2RlbCwgb2Zmc2V0OiBudW1iZXIpOiBtb25hY28uSVBvc2l0aW9uIHtcclxuICAvLyBcdHJldHVybiBtb2RlbC5nZXRQb3NpdGlvbkF0KG9mZnNldCk7XHJcbiAgLy8gfVxyXG4gIF90ZXh0U3BhblRvUmFuZ2UobW9kZWwsIHNwYW4pIHtcclxuICAgIGxldCBwMSA9IG1vZGVsLmdldFBvc2l0aW9uQXQoc3Bhbi5zdGFydCk7XHJcbiAgICBsZXQgcDIgPSBtb2RlbC5nZXRQb3NpdGlvbkF0KHNwYW4uc3RhcnQgKyBzcGFuLmxlbmd0aCk7XHJcbiAgICBsZXQgeyBsaW5lTnVtYmVyOiBzdGFydExpbmVOdW1iZXIsIGNvbHVtbjogc3RhcnRDb2x1bW4gfSA9IHAxO1xyXG4gICAgbGV0IHsgbGluZU51bWJlcjogZW5kTGluZU51bWJlciwgY29sdW1uOiBlbmRDb2x1bW4gfSA9IHAyO1xyXG4gICAgcmV0dXJuIHsgc3RhcnRMaW5lTnVtYmVyLCBzdGFydENvbHVtbiwgZW5kTGluZU51bWJlciwgZW5kQ29sdW1uIH07XHJcbiAgfVxyXG59O1xyXG52YXIgTGliRmlsZXMgPSBjbGFzcyB7XHJcbiAgY29uc3RydWN0b3IoX3dvcmtlcikge1xyXG4gICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcclxuICAgIHRoaXMuX2xpYkZpbGVzID0ge307XHJcbiAgICB0aGlzLl9oYXNGZXRjaGVkTGliRmlsZXMgPSBmYWxzZTtcclxuICAgIHRoaXMuX2ZldGNoTGliRmlsZXNQcm9taXNlID0gbnVsbDtcclxuICB9XHJcbiAgaXNMaWJGaWxlKHVyaSkge1xyXG4gICAgaWYgKCF1cmkpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKHVyaS5wYXRoLmluZGV4T2YoXCIvbGliLlwiKSA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gISFsaWJGaWxlU2V0W3VyaS5wYXRoLnNsaWNlKDEpXTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgZ2V0T3JDcmVhdGVNb2RlbChmaWxlTmFtZSkge1xyXG4gICAgY29uc3QgdXJpID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuVXJpLnBhcnNlKGZpbGVOYW1lKTtcclxuICAgIGNvbnN0IG1vZGVsID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmdldE1vZGVsKHVyaSk7XHJcbiAgICBpZiAobW9kZWwpIHtcclxuICAgICAgcmV0dXJuIG1vZGVsO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuaXNMaWJGaWxlKHVyaSkgJiYgdGhpcy5faGFzRmV0Y2hlZExpYkZpbGVzKSB7XHJcbiAgICAgIHJldHVybiBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5lZGl0b3IuY3JlYXRlTW9kZWwodGhpcy5fbGliRmlsZXNbdXJpLnBhdGguc2xpY2UoMSldLCBcInR5cGVzY3JpcHRcIiwgdXJpKTtcclxuICAgIH1cclxuICAgIGNvbnN0IG1hdGNoZWRMaWJGaWxlID0gdHlwZXNjcmlwdERlZmF1bHRzLmdldEV4dHJhTGlicygpW2ZpbGVOYW1lXTtcclxuICAgIGlmIChtYXRjaGVkTGliRmlsZSkge1xyXG4gICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmNyZWF0ZU1vZGVsKG1hdGNoZWRMaWJGaWxlLmNvbnRlbnQsIFwidHlwZXNjcmlwdFwiLCB1cmkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIF9jb250YWluc0xpYkZpbGUodXJpcykge1xyXG4gICAgZm9yIChsZXQgdXJpIG9mIHVyaXMpIHtcclxuICAgICAgaWYgKHRoaXMuaXNMaWJGaWxlKHVyaSkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBhc3luYyBmZXRjaExpYkZpbGVzSWZOZWNlc3NhcnkodXJpcykge1xyXG4gICAgaWYgKCF0aGlzLl9jb250YWluc0xpYkZpbGUodXJpcykpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgdGhpcy5fZmV0Y2hMaWJGaWxlcygpO1xyXG4gIH1cclxuICBfZmV0Y2hMaWJGaWxlcygpIHtcclxuICAgIGlmICghdGhpcy5fZmV0Y2hMaWJGaWxlc1Byb21pc2UpIHtcclxuICAgICAgdGhpcy5fZmV0Y2hMaWJGaWxlc1Byb21pc2UgPSB0aGlzLl93b3JrZXIoKS50aGVuKCh3KSA9PiB3LmdldExpYkZpbGVzKCkpLnRoZW4oKGxpYkZpbGVzKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFzRmV0Y2hlZExpYkZpbGVzID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9saWJGaWxlcyA9IGxpYkZpbGVzO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9mZXRjaExpYkZpbGVzUHJvbWlzZTtcclxuICB9XHJcbn07XHJcbnZhciBEaWFnbm9zdGljc0FkYXB0ZXIgPSBjbGFzcyBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKF9saWJGaWxlcywgX2RlZmF1bHRzLCBfc2VsZWN0b3IsIHdvcmtlcikge1xyXG4gICAgc3VwZXIod29ya2VyKTtcclxuICAgIHRoaXMuX2xpYkZpbGVzID0gX2xpYkZpbGVzO1xyXG4gICAgdGhpcy5fZGVmYXVsdHMgPSBfZGVmYXVsdHM7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IF9zZWxlY3RvcjtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzID0gW107XHJcbiAgICB0aGlzLl9saXN0ZW5lciA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgY29uc3Qgb25Nb2RlbEFkZCA9IChtb2RlbCkgPT4ge1xyXG4gICAgICBpZiAobW9kZWwuZ2V0TGFuZ3VhZ2VJZCgpICE9PSBfc2VsZWN0b3IpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgbWF5YmVWYWxpZGF0ZSA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB7IG9ubHlWaXNpYmxlIH0gPSB0aGlzLl9kZWZhdWx0cy5nZXREaWFnbm9zdGljc09wdGlvbnMoKTtcclxuICAgICAgICBpZiAob25seVZpc2libGUpIHtcclxuICAgICAgICAgIGlmIChtb2RlbC5pc0F0dGFjaGVkVG9FZGl0b3IoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kb1ZhbGlkYXRlKG1vZGVsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5fZG9WYWxpZGF0ZShtb2RlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBsZXQgaGFuZGxlO1xyXG4gICAgICBjb25zdCBjaGFuZ2VTdWJzY3JpcHRpb24gPSBtb2RlbC5vbkRpZENoYW5nZUNvbnRlbnQoKCkgPT4ge1xyXG4gICAgICAgIGNsZWFyVGltZW91dChoYW5kbGUpO1xyXG4gICAgICAgIGhhbmRsZSA9IHdpbmRvdy5zZXRUaW1lb3V0KG1heWJlVmFsaWRhdGUsIDUwMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCB2aXNpYmxlU3Vic2NyaXB0aW9uID0gbW9kZWwub25EaWRDaGFuZ2VBdHRhY2hlZCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBvbmx5VmlzaWJsZSB9ID0gdGhpcy5fZGVmYXVsdHMuZ2V0RGlhZ25vc3RpY3NPcHRpb25zKCk7XHJcbiAgICAgICAgaWYgKG9ubHlWaXNpYmxlKSB7XHJcbiAgICAgICAgICBpZiAobW9kZWwuaXNBdHRhY2hlZFRvRWRpdG9yKCkpIHtcclxuICAgICAgICAgICAgbWF5YmVWYWxpZGF0ZSgpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLnNldE1vZGVsTWFya2Vycyhtb2RlbCwgdGhpcy5fc2VsZWN0b3IsIFtdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLl9saXN0ZW5lclttb2RlbC51cmkudG9TdHJpbmcoKV0gPSB7XHJcbiAgICAgICAgZGlzcG9zZSgpIHtcclxuICAgICAgICAgIGNoYW5nZVN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XHJcbiAgICAgICAgICB2aXNpYmxlU3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcclxuICAgICAgICAgIGNsZWFyVGltZW91dChoYW5kbGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgbWF5YmVWYWxpZGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG9uTW9kZWxSZW1vdmVkID0gKG1vZGVsKSA9PiB7XHJcbiAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmVkaXRvci5zZXRNb2RlbE1hcmtlcnMobW9kZWwsIHRoaXMuX3NlbGVjdG9yLCBbXSk7XHJcbiAgICAgIGNvbnN0IGtleSA9IG1vZGVsLnVyaS50b1N0cmluZygpO1xyXG4gICAgICBpZiAodGhpcy5fbGlzdGVuZXJba2V5XSkge1xyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyW2tleV0uZGlzcG9zZSgpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9saXN0ZW5lcltrZXldO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMucHVzaChcclxuICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLm9uRGlkQ3JlYXRlTW9kZWwoKG1vZGVsKSA9PiBvbk1vZGVsQWRkKG1vZGVsKSlcclxuICAgICk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5wdXNoKG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmVkaXRvci5vbldpbGxEaXNwb3NlTW9kZWwob25Nb2RlbFJlbW92ZWQpKTtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLnB1c2goXHJcbiAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmVkaXRvci5vbkRpZENoYW5nZU1vZGVsTGFuZ3VhZ2UoKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgb25Nb2RlbFJlbW92ZWQoZXZlbnQubW9kZWwpO1xyXG4gICAgICAgIG9uTW9kZWxBZGQoZXZlbnQubW9kZWwpO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLnB1c2goe1xyXG4gICAgICBkaXNwb3NlKCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgbW9kZWwgb2YgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmdldE1vZGVscygpKSB7XHJcbiAgICAgICAgICBvbk1vZGVsUmVtb3ZlZChtb2RlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHJlY29tcHV0ZURpYWdvc3RpY3MgPSAoKSA9PiB7XHJcbiAgICAgIGZvciAoY29uc3QgbW9kZWwgb2YgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuZWRpdG9yLmdldE1vZGVscygpKSB7XHJcbiAgICAgICAgb25Nb2RlbFJlbW92ZWQobW9kZWwpO1xyXG4gICAgICAgIG9uTW9kZWxBZGQobW9kZWwpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMucHVzaCh0aGlzLl9kZWZhdWx0cy5vbkRpZENoYW5nZShyZWNvbXB1dGVEaWFnb3N0aWNzKSk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5wdXNoKHRoaXMuX2RlZmF1bHRzLm9uRGlkRXh0cmFMaWJzQ2hhbmdlKHJlY29tcHV0ZURpYWdvc3RpY3MpKTtcclxuICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmVkaXRvci5nZXRNb2RlbHMoKS5mb3JFYWNoKChtb2RlbCkgPT4gb25Nb2RlbEFkZChtb2RlbCkpO1xyXG4gIH1cclxuICBkaXNwb3NlKCkge1xyXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMuZm9yRWFjaCgoZCkgPT4gZCAmJiBkLmRpc3Bvc2UoKSk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IFtdO1xyXG4gIH1cclxuICBhc3luYyBfZG9WYWxpZGF0ZShtb2RlbCkge1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKG1vZGVsLnVyaSk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHByb21pc2VzID0gW107XHJcbiAgICBjb25zdCB7IG5vU3ludGF4VmFsaWRhdGlvbiwgbm9TZW1hbnRpY1ZhbGlkYXRpb24sIG5vU3VnZ2VzdGlvbkRpYWdub3N0aWNzIH0gPSB0aGlzLl9kZWZhdWx0cy5nZXREaWFnbm9zdGljc09wdGlvbnMoKTtcclxuICAgIGlmICghbm9TeW50YXhWYWxpZGF0aW9uKSB7XHJcbiAgICAgIHByb21pc2VzLnB1c2god29ya2VyLmdldFN5bnRhY3RpY0RpYWdub3N0aWNzKG1vZGVsLnVyaS50b1N0cmluZygpKSk7XHJcbiAgICB9XHJcbiAgICBpZiAoIW5vU2VtYW50aWNWYWxpZGF0aW9uKSB7XHJcbiAgICAgIHByb21pc2VzLnB1c2god29ya2VyLmdldFNlbWFudGljRGlhZ25vc3RpY3MobW9kZWwudXJpLnRvU3RyaW5nKCkpKTtcclxuICAgIH1cclxuICAgIGlmICghbm9TdWdnZXN0aW9uRGlhZ25vc3RpY3MpIHtcclxuICAgICAgcHJvbWlzZXMucHVzaCh3b3JrZXIuZ2V0U3VnZ2VzdGlvbkRpYWdub3N0aWNzKG1vZGVsLnVyaS50b1N0cmluZygpKSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBhbGxEaWFnbm9zdGljcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcclxuICAgIGlmICghYWxsRGlhZ25vc3RpY3MgfHwgbW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGRpYWdub3N0aWNzID0gYWxsRGlhZ25vc3RpY3MucmVkdWNlKChwLCBjKSA9PiBjLmNvbmNhdChwKSwgW10pLmZpbHRlcihcclxuICAgICAgKGQpID0+ICh0aGlzLl9kZWZhdWx0cy5nZXREaWFnbm9zdGljc09wdGlvbnMoKS5kaWFnbm9zdGljQ29kZXNUb0lnbm9yZSB8fCBbXSkuaW5kZXhPZihkLmNvZGUpID09PSAtMVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHJlbGF0ZWRVcmlzID0gZGlhZ25vc3RpY3MubWFwKChkKSA9PiBkLnJlbGF0ZWRJbmZvcm1hdGlvbiB8fCBbXSkucmVkdWNlKChwLCBjKSA9PiBjLmNvbmNhdChwKSwgW10pLm1hcChcclxuICAgICAgKHJlbGF0ZWRJbmZvcm1hdGlvbikgPT4gcmVsYXRlZEluZm9ybWF0aW9uLmZpbGUgPyBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5VcmkucGFyc2UocmVsYXRlZEluZm9ybWF0aW9uLmZpbGUuZmlsZU5hbWUpIDogbnVsbFxyXG4gICAgKTtcclxuICAgIGF3YWl0IHRoaXMuX2xpYkZpbGVzLmZldGNoTGliRmlsZXNJZk5lY2Vzc2FyeShyZWxhdGVkVXJpcyk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmVkaXRvci5zZXRNb2RlbE1hcmtlcnMoXHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICB0aGlzLl9zZWxlY3RvcixcclxuICAgICAgZGlhZ25vc3RpY3MubWFwKChkKSA9PiB0aGlzLl9jb252ZXJ0RGlhZ25vc3RpY3MobW9kZWwsIGQpKVxyXG4gICAgKTtcclxuICB9XHJcbiAgX2NvbnZlcnREaWFnbm9zdGljcyhtb2RlbCwgZGlhZykge1xyXG4gICAgY29uc3QgZGlhZ1N0YXJ0ID0gZGlhZy5zdGFydCB8fCAwO1xyXG4gICAgY29uc3QgZGlhZ0xlbmd0aCA9IGRpYWcubGVuZ3RoIHx8IDE7XHJcbiAgICBjb25zdCB7IGxpbmVOdW1iZXI6IHN0YXJ0TGluZU51bWJlciwgY29sdW1uOiBzdGFydENvbHVtbiB9ID0gbW9kZWwuZ2V0UG9zaXRpb25BdChkaWFnU3RhcnQpO1xyXG4gICAgY29uc3QgeyBsaW5lTnVtYmVyOiBlbmRMaW5lTnVtYmVyLCBjb2x1bW46IGVuZENvbHVtbiB9ID0gbW9kZWwuZ2V0UG9zaXRpb25BdChcclxuICAgICAgZGlhZ1N0YXJ0ICsgZGlhZ0xlbmd0aFxyXG4gICAgKTtcclxuICAgIGNvbnN0IHRhZ3MgPSBbXTtcclxuICAgIGlmIChkaWFnLnJlcG9ydHNVbm5lY2Vzc2FyeSkge1xyXG4gICAgICB0YWdzLnB1c2gobW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuTWFya2VyVGFnLlVubmVjZXNzYXJ5KTtcclxuICAgIH1cclxuICAgIGlmIChkaWFnLnJlcG9ydHNEZXByZWNhdGVkKSB7XHJcbiAgICAgIHRhZ3MucHVzaChtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5NYXJrZXJUYWcuRGVwcmVjYXRlZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzZXZlcml0eTogdGhpcy5fdHNEaWFnbm9zdGljQ2F0ZWdvcnlUb01hcmtlclNldmVyaXR5KGRpYWcuY2F0ZWdvcnkpLFxyXG4gICAgICBzdGFydExpbmVOdW1iZXIsXHJcbiAgICAgIHN0YXJ0Q29sdW1uLFxyXG4gICAgICBlbmRMaW5lTnVtYmVyLFxyXG4gICAgICBlbmRDb2x1bW4sXHJcbiAgICAgIG1lc3NhZ2U6IGZsYXR0ZW5EaWFnbm9zdGljTWVzc2FnZVRleHQoZGlhZy5tZXNzYWdlVGV4dCwgXCJcXG5cIiksXHJcbiAgICAgIGNvZGU6IGRpYWcuY29kZS50b1N0cmluZygpLFxyXG4gICAgICB0YWdzLFxyXG4gICAgICByZWxhdGVkSW5mb3JtYXRpb246IHRoaXMuX2NvbnZlcnRSZWxhdGVkSW5mb3JtYXRpb24obW9kZWwsIGRpYWcucmVsYXRlZEluZm9ybWF0aW9uKVxyXG4gICAgfTtcclxuICB9XHJcbiAgX2NvbnZlcnRSZWxhdGVkSW5mb3JtYXRpb24obW9kZWwsIHJlbGF0ZWRJbmZvcm1hdGlvbikge1xyXG4gICAgaWYgKCFyZWxhdGVkSW5mb3JtYXRpb24pIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICByZWxhdGVkSW5mb3JtYXRpb24uZm9yRWFjaCgoaW5mbykgPT4ge1xyXG4gICAgICBsZXQgcmVsYXRlZFJlc291cmNlID0gbW9kZWw7XHJcbiAgICAgIGlmIChpbmZvLmZpbGUpIHtcclxuICAgICAgICByZWxhdGVkUmVzb3VyY2UgPSB0aGlzLl9saWJGaWxlcy5nZXRPckNyZWF0ZU1vZGVsKGluZm8uZmlsZS5maWxlTmFtZSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCFyZWxhdGVkUmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgaW5mb1N0YXJ0ID0gaW5mby5zdGFydCB8fCAwO1xyXG4gICAgICBjb25zdCBpbmZvTGVuZ3RoID0gaW5mby5sZW5ndGggfHwgMTtcclxuICAgICAgY29uc3QgeyBsaW5lTnVtYmVyOiBzdGFydExpbmVOdW1iZXIsIGNvbHVtbjogc3RhcnRDb2x1bW4gfSA9IHJlbGF0ZWRSZXNvdXJjZS5nZXRQb3NpdGlvbkF0KGluZm9TdGFydCk7XHJcbiAgICAgIGNvbnN0IHsgbGluZU51bWJlcjogZW5kTGluZU51bWJlciwgY29sdW1uOiBlbmRDb2x1bW4gfSA9IHJlbGF0ZWRSZXNvdXJjZS5nZXRQb3NpdGlvbkF0KFxyXG4gICAgICAgIGluZm9TdGFydCArIGluZm9MZW5ndGhcclxuICAgICAgKTtcclxuICAgICAgcmVzdWx0LnB1c2goe1xyXG4gICAgICAgIHJlc291cmNlOiByZWxhdGVkUmVzb3VyY2UudXJpLFxyXG4gICAgICAgIHN0YXJ0TGluZU51bWJlcixcclxuICAgICAgICBzdGFydENvbHVtbixcclxuICAgICAgICBlbmRMaW5lTnVtYmVyLFxyXG4gICAgICAgIGVuZENvbHVtbixcclxuICAgICAgICBtZXNzYWdlOiBmbGF0dGVuRGlhZ25vc3RpY01lc3NhZ2VUZXh0KGluZm8ubWVzc2FnZVRleHQsIFwiXFxuXCIpXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuICBfdHNEaWFnbm9zdGljQ2F0ZWdvcnlUb01hcmtlclNldmVyaXR5KGNhdGVnb3J5KSB7XHJcbiAgICBzd2l0Y2ggKGNhdGVnb3J5KSB7XHJcbiAgICAgIGNhc2UgMSAvKiBFcnJvciAqLzpcclxuICAgICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuTWFya2VyU2V2ZXJpdHkuRXJyb3I7XHJcbiAgICAgIGNhc2UgMyAvKiBNZXNzYWdlICovOlxyXG4gICAgICAgIHJldHVybiBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5NYXJrZXJTZXZlcml0eS5JbmZvO1xyXG4gICAgICBjYXNlIDAgLyogV2FybmluZyAqLzpcclxuICAgICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuTWFya2VyU2V2ZXJpdHkuV2FybmluZztcclxuICAgICAgY2FzZSAyIC8qIFN1Z2dlc3Rpb24gKi86XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLk1hcmtlclNldmVyaXR5LkhpbnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuTWFya2VyU2V2ZXJpdHkuSW5mbztcclxuICB9XHJcbn07XHJcbnZhciBTdWdnZXN0QWRhcHRlciA9IGNsYXNzIF9TdWdnZXN0QWRhcHRlciBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGdldCB0cmlnZ2VyQ2hhcmFjdGVycygpIHtcclxuICAgIHJldHVybiBbXCIuXCJdO1xyXG4gIH1cclxuICBhc3luYyBwcm92aWRlQ29tcGxldGlvbkl0ZW1zKG1vZGVsLCBwb3NpdGlvbiwgX2NvbnRleHQsIHRva2VuKSB7XHJcbiAgICBjb25zdCB3b3JkSW5mbyA9IG1vZGVsLmdldFdvcmRVbnRpbFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgIGNvbnN0IHdvcmRSYW5nZSA9IG5ldyBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5SYW5nZShcclxuICAgICAgcG9zaXRpb24ubGluZU51bWJlcixcclxuICAgICAgd29yZEluZm8uc3RhcnRDb2x1bW4sXHJcbiAgICAgIHBvc2l0aW9uLmxpbmVOdW1iZXIsXHJcbiAgICAgIHdvcmRJbmZvLmVuZENvbHVtblxyXG4gICAgKTtcclxuICAgIGNvbnN0IHJlc291cmNlID0gbW9kZWwudXJpO1xyXG4gICAgY29uc3Qgb2Zmc2V0ID0gbW9kZWwuZ2V0T2Zmc2V0QXQocG9zaXRpb24pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IHdvcmtlci5nZXRDb21wbGV0aW9uc0F0UG9zaXRpb24ocmVzb3VyY2UudG9TdHJpbmcoKSwgb2Zmc2V0KTtcclxuICAgIGlmICghaW5mbyB8fCBtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBpbmZvLmVudHJpZXMubWFwKChlbnRyeSkgPT4ge1xyXG4gICAgICBsZXQgcmFuZ2UgPSB3b3JkUmFuZ2U7XHJcbiAgICAgIGlmIChlbnRyeS5yZXBsYWNlbWVudFNwYW4pIHtcclxuICAgICAgICBjb25zdCBwMSA9IG1vZGVsLmdldFBvc2l0aW9uQXQoZW50cnkucmVwbGFjZW1lbnRTcGFuLnN0YXJ0KTtcclxuICAgICAgICBjb25zdCBwMiA9IG1vZGVsLmdldFBvc2l0aW9uQXQoZW50cnkucmVwbGFjZW1lbnRTcGFuLnN0YXJ0ICsgZW50cnkucmVwbGFjZW1lbnRTcGFuLmxlbmd0aCk7XHJcbiAgICAgICAgcmFuZ2UgPSBuZXcgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuUmFuZ2UocDEubGluZU51bWJlciwgcDEuY29sdW1uLCBwMi5saW5lTnVtYmVyLCBwMi5jb2x1bW4pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHRhZ3MgPSBbXTtcclxuICAgICAgaWYgKGVudHJ5LmtpbmRNb2RpZmllcnMgIT09IHZvaWQgMCAmJiBlbnRyeS5raW5kTW9kaWZpZXJzLmluZGV4T2YoXCJkZXByZWNhdGVkXCIpICE9PSAtMSkge1xyXG4gICAgICAgIHRhZ3MucHVzaChtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1UYWcuRGVwcmVjYXRlZCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB1cmk6IHJlc291cmNlLFxyXG4gICAgICAgIHBvc2l0aW9uLFxyXG4gICAgICAgIG9mZnNldCxcclxuICAgICAgICByYW5nZSxcclxuICAgICAgICBsYWJlbDogZW50cnkubmFtZSxcclxuICAgICAgICBpbnNlcnRUZXh0OiBlbnRyeS5uYW1lLFxyXG4gICAgICAgIHNvcnRUZXh0OiBlbnRyeS5zb3J0VGV4dCxcclxuICAgICAgICBraW5kOiBfU3VnZ2VzdEFkYXB0ZXIuY29udmVydEtpbmQoZW50cnkua2luZCksXHJcbiAgICAgICAgdGFnc1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWdnZXN0aW9uc1xyXG4gICAgfTtcclxuICB9XHJcbiAgYXN5bmMgcmVzb2x2ZUNvbXBsZXRpb25JdGVtKGl0ZW0sIHRva2VuKSB7XHJcbiAgICBjb25zdCBteUl0ZW0gPSBpdGVtO1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBteUl0ZW0udXJpO1xyXG4gICAgY29uc3QgcG9zaXRpb24gPSBteUl0ZW0ucG9zaXRpb247XHJcbiAgICBjb25zdCBvZmZzZXQgPSBteUl0ZW0ub2Zmc2V0O1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGNvbnN0IGRldGFpbHMgPSBhd2FpdCB3b3JrZXIuZ2V0Q29tcGxldGlvbkVudHJ5RGV0YWlscyhcclxuICAgICAgcmVzb3VyY2UudG9TdHJpbmcoKSxcclxuICAgICAgb2Zmc2V0LFxyXG4gICAgICBteUl0ZW0ubGFiZWxcclxuICAgICk7XHJcbiAgICBpZiAoIWRldGFpbHMpIHtcclxuICAgICAgcmV0dXJuIG15SXRlbTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVyaTogcmVzb3VyY2UsXHJcbiAgICAgIHBvc2l0aW9uLFxyXG4gICAgICBsYWJlbDogZGV0YWlscy5uYW1lLFxyXG4gICAgICBraW5kOiBfU3VnZ2VzdEFkYXB0ZXIuY29udmVydEtpbmQoZGV0YWlscy5raW5kKSxcclxuICAgICAgZGV0YWlsOiBkaXNwbGF5UGFydHNUb1N0cmluZyhkZXRhaWxzLmRpc3BsYXlQYXJ0cyksXHJcbiAgICAgIGRvY3VtZW50YXRpb246IHtcclxuICAgICAgICB2YWx1ZTogX1N1Z2dlc3RBZGFwdGVyLmNyZWF0ZURvY3VtZW50YXRpb25TdHJpbmcoZGV0YWlscylcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcbiAgc3RhdGljIGNvbnZlcnRLaW5kKGtpbmQpIHtcclxuICAgIHN3aXRjaCAoa2luZCkge1xyXG4gICAgICBjYXNlIEtpbmQucHJpbWl0aXZlVHlwZTpcclxuICAgICAgY2FzZSBLaW5kLmtleXdvcmQ6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuS2V5d29yZDtcclxuICAgICAgY2FzZSBLaW5kLnZhcmlhYmxlOlxyXG4gICAgICBjYXNlIEtpbmQubG9jYWxWYXJpYWJsZTpcclxuICAgICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLkNvbXBsZXRpb25JdGVtS2luZC5WYXJpYWJsZTtcclxuICAgICAgY2FzZSBLaW5kLm1lbWJlclZhcmlhYmxlOlxyXG4gICAgICBjYXNlIEtpbmQubWVtYmVyR2V0QWNjZXNzb3I6XHJcbiAgICAgIGNhc2UgS2luZC5tZW1iZXJTZXRBY2Nlc3NvcjpcclxuICAgICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLkNvbXBsZXRpb25JdGVtS2luZC5GaWVsZDtcclxuICAgICAgY2FzZSBLaW5kLmZ1bmN0aW9uOlxyXG4gICAgICBjYXNlIEtpbmQubWVtYmVyRnVuY3Rpb246XHJcbiAgICAgIGNhc2UgS2luZC5jb25zdHJ1Y3RTaWduYXR1cmU6XHJcbiAgICAgIGNhc2UgS2luZC5jYWxsU2lnbmF0dXJlOlxyXG4gICAgICBjYXNlIEtpbmQuaW5kZXhTaWduYXR1cmU6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuRnVuY3Rpb247XHJcbiAgICAgIGNhc2UgS2luZC5lbnVtOlxyXG4gICAgICAgIHJldHVybiBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1LaW5kLkVudW07XHJcbiAgICAgIGNhc2UgS2luZC5tb2R1bGU6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuTW9kdWxlO1xyXG4gICAgICBjYXNlIEtpbmQuY2xhc3M6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuQ2xhc3M7XHJcbiAgICAgIGNhc2UgS2luZC5pbnRlcmZhY2U6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuSW50ZXJmYWNlO1xyXG4gICAgICBjYXNlIEtpbmQud2FybmluZzpcclxuICAgICAgICByZXR1cm4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLkNvbXBsZXRpb25JdGVtS2luZC5GaWxlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Db21wbGV0aW9uSXRlbUtpbmQuUHJvcGVydHk7XHJcbiAgfVxyXG4gIHN0YXRpYyBjcmVhdGVEb2N1bWVudGF0aW9uU3RyaW5nKGRldGFpbHMpIHtcclxuICAgIGxldCBkb2N1bWVudGF0aW9uU3RyaW5nID0gZGlzcGxheVBhcnRzVG9TdHJpbmcoZGV0YWlscy5kb2N1bWVudGF0aW9uKTtcclxuICAgIGlmIChkZXRhaWxzLnRhZ3MpIHtcclxuICAgICAgZm9yIChjb25zdCB0YWcgb2YgZGV0YWlscy50YWdzKSB7XHJcbiAgICAgICAgZG9jdW1lbnRhdGlvblN0cmluZyArPSBgXHJcblxyXG4ke3RhZ1RvU3RyaW5nKHRhZyl9YDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvY3VtZW50YXRpb25TdHJpbmc7XHJcbiAgfVxyXG59O1xyXG5mdW5jdGlvbiB0YWdUb1N0cmluZyh0YWcpIHtcclxuICBsZXQgdGFnTGFiZWwgPSBgKkAke3RhZy5uYW1lfSpgO1xyXG4gIGlmICh0YWcubmFtZSA9PT0gXCJwYXJhbVwiICYmIHRhZy50ZXh0KSB7XHJcbiAgICBjb25zdCBbcGFyYW1OYW1lLCAuLi5yZXN0XSA9IHRhZy50ZXh0O1xyXG4gICAgdGFnTGFiZWwgKz0gYFxcYCR7cGFyYW1OYW1lLnRleHR9XFxgYDtcclxuICAgIGlmIChyZXN0Lmxlbmd0aCA+IDApXHJcbiAgICAgIHRhZ0xhYmVsICs9IGAgXFx1MjAxNCAke3Jlc3QubWFwKChyKSA9PiByLnRleHQpLmpvaW4oXCIgXCIpfWA7XHJcbiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhZy50ZXh0KSkge1xyXG4gICAgdGFnTGFiZWwgKz0gYCBcXHUyMDE0ICR7dGFnLnRleHQubWFwKChyKSA9PiByLnRleHQpLmpvaW4oXCIgXCIpfWA7XHJcbiAgfSBlbHNlIGlmICh0YWcudGV4dCkge1xyXG4gICAgdGFnTGFiZWwgKz0gYCBcXHUyMDE0ICR7dGFnLnRleHR9YDtcclxuICB9XHJcbiAgcmV0dXJuIHRhZ0xhYmVsO1xyXG59XHJcbnZhciBTaWduYXR1cmVIZWxwQWRhcHRlciA9IGNsYXNzIF9TaWduYXR1cmVIZWxwQWRhcHRlciBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcclxuICAgIHRoaXMuc2lnbmF0dXJlSGVscFRyaWdnZXJDaGFyYWN0ZXJzID0gW1wiKFwiLCBcIixcIl07XHJcbiAgfVxyXG4gIHN0YXRpYyBfdG9TaWduYXR1cmVIZWxwVHJpZ2dlclJlYXNvbihjb250ZXh0KSB7XHJcbiAgICBzd2l0Y2ggKGNvbnRleHQudHJpZ2dlcktpbmQpIHtcclxuICAgICAgY2FzZSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU2lnbmF0dXJlSGVscFRyaWdnZXJLaW5kLlRyaWdnZXJDaGFyYWN0ZXI6XHJcbiAgICAgICAgaWYgKGNvbnRleHQudHJpZ2dlckNoYXJhY3Rlcikge1xyXG4gICAgICAgICAgaWYgKGNvbnRleHQuaXNSZXRyaWdnZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsga2luZDogXCJyZXRyaWdnZXJcIiwgdHJpZ2dlckNoYXJhY3RlcjogY29udGV4dC50cmlnZ2VyQ2hhcmFjdGVyIH07XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4geyBraW5kOiBcImNoYXJhY3RlclR5cGVkXCIsIHRyaWdnZXJDaGFyYWN0ZXI6IGNvbnRleHQudHJpZ2dlckNoYXJhY3RlciB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4geyBraW5kOiBcImludm9rZWRcIiB9O1xyXG4gICAgICAgIH1cclxuICAgICAgY2FzZSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU2lnbmF0dXJlSGVscFRyaWdnZXJLaW5kLkNvbnRlbnRDaGFuZ2U6XHJcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuaXNSZXRyaWdnZXIgPyB7IGtpbmQ6IFwicmV0cmlnZ2VyXCIgfSA6IHsga2luZDogXCJpbnZva2VkXCIgfTtcclxuICAgICAgY2FzZSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU2lnbmF0dXJlSGVscFRyaWdnZXJLaW5kLkludm9rZTpcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4geyBraW5kOiBcImludm9rZWRcIiB9O1xyXG4gICAgfVxyXG4gIH1cclxuICBhc3luYyBwcm92aWRlU2lnbmF0dXJlSGVscChtb2RlbCwgcG9zaXRpb24sIHRva2VuLCBjb250ZXh0KSB7XHJcbiAgICBjb25zdCByZXNvdXJjZSA9IG1vZGVsLnVyaTtcclxuICAgIGNvbnN0IG9mZnNldCA9IG1vZGVsLmdldE9mZnNldEF0KHBvc2l0aW9uKTtcclxuICAgIGNvbnN0IHdvcmtlciA9IGF3YWl0IHRoaXMuX3dvcmtlcihyZXNvdXJjZSk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZm8gPSBhd2FpdCB3b3JrZXIuZ2V0U2lnbmF0dXJlSGVscEl0ZW1zKHJlc291cmNlLnRvU3RyaW5nKCksIG9mZnNldCwge1xyXG4gICAgICB0cmlnZ2VyUmVhc29uOiBfU2lnbmF0dXJlSGVscEFkYXB0ZXIuX3RvU2lnbmF0dXJlSGVscFRyaWdnZXJSZWFzb24oY29udGV4dClcclxuICAgIH0pO1xyXG4gICAgaWYgKCFpbmZvIHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXQgPSB7XHJcbiAgICAgIGFjdGl2ZVNpZ25hdHVyZTogaW5mby5zZWxlY3RlZEl0ZW1JbmRleCxcclxuICAgICAgYWN0aXZlUGFyYW1ldGVyOiBpbmZvLmFyZ3VtZW50SW5kZXgsXHJcbiAgICAgIHNpZ25hdHVyZXM6IFtdXHJcbiAgICB9O1xyXG4gICAgaW5mby5pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHtcclxuICAgICAgICBsYWJlbDogXCJcIixcclxuICAgICAgICBwYXJhbWV0ZXJzOiBbXVxyXG4gICAgICB9O1xyXG4gICAgICBzaWduYXR1cmUuZG9jdW1lbnRhdGlvbiA9IHtcclxuICAgICAgICB2YWx1ZTogZGlzcGxheVBhcnRzVG9TdHJpbmcoaXRlbS5kb2N1bWVudGF0aW9uKVxyXG4gICAgICB9O1xyXG4gICAgICBzaWduYXR1cmUubGFiZWwgKz0gZGlzcGxheVBhcnRzVG9TdHJpbmcoaXRlbS5wcmVmaXhEaXNwbGF5UGFydHMpO1xyXG4gICAgICBpdGVtLnBhcmFtZXRlcnMuZm9yRWFjaCgocCwgaSwgYSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGxhYmVsID0gZGlzcGxheVBhcnRzVG9TdHJpbmcocC5kaXNwbGF5UGFydHMpO1xyXG4gICAgICAgIGNvbnN0IHBhcmFtZXRlciA9IHtcclxuICAgICAgICAgIGxhYmVsLFxyXG4gICAgICAgICAgZG9jdW1lbnRhdGlvbjoge1xyXG4gICAgICAgICAgICB2YWx1ZTogZGlzcGxheVBhcnRzVG9TdHJpbmcocC5kb2N1bWVudGF0aW9uKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2lnbmF0dXJlLmxhYmVsICs9IGxhYmVsO1xyXG4gICAgICAgIHNpZ25hdHVyZS5wYXJhbWV0ZXJzLnB1c2gocGFyYW1ldGVyKTtcclxuICAgICAgICBpZiAoaSA8IGEubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgc2lnbmF0dXJlLmxhYmVsICs9IGRpc3BsYXlQYXJ0c1RvU3RyaW5nKGl0ZW0uc2VwYXJhdG9yRGlzcGxheVBhcnRzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBzaWduYXR1cmUubGFiZWwgKz0gZGlzcGxheVBhcnRzVG9TdHJpbmcoaXRlbS5zdWZmaXhEaXNwbGF5UGFydHMpO1xyXG4gICAgICByZXQuc2lnbmF0dXJlcy5wdXNoKHNpZ25hdHVyZSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHZhbHVlOiByZXQsXHJcbiAgICAgIGRpc3Bvc2UoKSB7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG59O1xyXG52YXIgUXVpY2tJbmZvQWRhcHRlciA9IGNsYXNzIGV4dGVuZHMgQWRhcHRlciB7XHJcbiAgYXN5bmMgcHJvdmlkZUhvdmVyKG1vZGVsLCBwb3NpdGlvbiwgdG9rZW4pIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0gbW9kZWwudXJpO1xyXG4gICAgY29uc3Qgb2Zmc2V0ID0gbW9kZWwuZ2V0T2Zmc2V0QXQocG9zaXRpb24pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IHdvcmtlci5nZXRRdWlja0luZm9BdFBvc2l0aW9uKHJlc291cmNlLnRvU3RyaW5nKCksIG9mZnNldCk7XHJcbiAgICBpZiAoIWluZm8gfHwgbW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGRvY3VtZW50YXRpb24gPSBkaXNwbGF5UGFydHNUb1N0cmluZyhpbmZvLmRvY3VtZW50YXRpb24pO1xyXG4gICAgY29uc3QgdGFncyA9IGluZm8udGFncyA/IGluZm8udGFncy5tYXAoKHRhZykgPT4gdGFnVG9TdHJpbmcodGFnKSkuam9pbihcIiAgXFxuXFxuXCIpIDogXCJcIjtcclxuICAgIGNvbnN0IGNvbnRlbnRzID0gZGlzcGxheVBhcnRzVG9TdHJpbmcoaW5mby5kaXNwbGF5UGFydHMpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmFuZ2U6IHRoaXMuX3RleHRTcGFuVG9SYW5nZShtb2RlbCwgaW5mby50ZXh0U3BhbiksXHJcbiAgICAgIGNvbnRlbnRzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdmFsdWU6IFwiYGBgdHlwZXNjcmlwdFxcblwiICsgY29udGVudHMgKyBcIlxcbmBgYFxcblwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB2YWx1ZTogZG9jdW1lbnRhdGlvbiArICh0YWdzID8gXCJcXG5cXG5cIiArIHRhZ3MgOiBcIlwiKVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfTtcclxuICB9XHJcbn07XHJcbnZhciBEb2N1bWVudEhpZ2hsaWdodEFkYXB0ZXIgPSBjbGFzcyBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGFzeW5jIHByb3ZpZGVEb2N1bWVudEhpZ2hsaWdodHMobW9kZWwsIHBvc2l0aW9uLCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCBvZmZzZXQgPSBtb2RlbC5nZXRPZmZzZXRBdChwb3NpdGlvbik7XHJcbiAgICBjb25zdCB3b3JrZXIgPSBhd2FpdCB0aGlzLl93b3JrZXIocmVzb3VyY2UpO1xyXG4gICAgaWYgKG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBlbnRyaWVzID0gYXdhaXQgd29ya2VyLmdldERvY3VtZW50SGlnaGxpZ2h0cyhyZXNvdXJjZS50b1N0cmluZygpLCBvZmZzZXQsIFtcclxuICAgICAgcmVzb3VyY2UudG9TdHJpbmcoKVxyXG4gICAgXSk7XHJcbiAgICBpZiAoIWVudHJpZXMgfHwgbW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHJldHVybiBlbnRyaWVzLmZsYXRNYXAoKGVudHJ5KSA9PiB7XHJcbiAgICAgIHJldHVybiBlbnRyeS5oaWdobGlnaHRTcGFucy5tYXAoKGhpZ2hsaWdodFNwYW5zKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHJhbmdlOiB0aGlzLl90ZXh0U3BhblRvUmFuZ2UobW9kZWwsIGhpZ2hsaWdodFNwYW5zLnRleHRTcGFuKSxcclxuICAgICAgICAgIGtpbmQ6IGhpZ2hsaWdodFNwYW5zLmtpbmQgPT09IFwid3JpdHRlblJlZmVyZW5jZVwiID8gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLkRvY3VtZW50SGlnaGxpZ2h0S2luZC5Xcml0ZSA6IG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5Eb2N1bWVudEhpZ2hsaWdodEtpbmQuVGV4dFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG52YXIgRGVmaW5pdGlvbkFkYXB0ZXIgPSBjbGFzcyBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKF9saWJGaWxlcywgd29ya2VyKSB7XHJcbiAgICBzdXBlcih3b3JrZXIpO1xyXG4gICAgdGhpcy5fbGliRmlsZXMgPSBfbGliRmlsZXM7XHJcbiAgfVxyXG4gIGFzeW5jIHByb3ZpZGVEZWZpbml0aW9uKG1vZGVsLCBwb3NpdGlvbiwgdG9rZW4pIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0gbW9kZWwudXJpO1xyXG4gICAgY29uc3Qgb2Zmc2V0ID0gbW9kZWwuZ2V0T2Zmc2V0QXQocG9zaXRpb24pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZW50cmllcyA9IGF3YWl0IHdvcmtlci5nZXREZWZpbml0aW9uQXRQb3NpdGlvbihyZXNvdXJjZS50b1N0cmluZygpLCBvZmZzZXQpO1xyXG4gICAgaWYgKCFlbnRyaWVzIHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBhd2FpdCB0aGlzLl9saWJGaWxlcy5mZXRjaExpYkZpbGVzSWZOZWNlc3NhcnkoXHJcbiAgICAgIGVudHJpZXMubWFwKChlbnRyeSkgPT4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuVXJpLnBhcnNlKGVudHJ5LmZpbGVOYW1lKSlcclxuICAgICk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgZm9yIChsZXQgZW50cnkgb2YgZW50cmllcykge1xyXG4gICAgICBjb25zdCByZWZNb2RlbCA9IHRoaXMuX2xpYkZpbGVzLmdldE9yQ3JlYXRlTW9kZWwoZW50cnkuZmlsZU5hbWUpO1xyXG4gICAgICBpZiAocmVmTW9kZWwpIHtcclxuICAgICAgICByZXN1bHQucHVzaCh7XHJcbiAgICAgICAgICB1cmk6IHJlZk1vZGVsLnVyaSxcclxuICAgICAgICAgIHJhbmdlOiB0aGlzLl90ZXh0U3BhblRvUmFuZ2UocmVmTW9kZWwsIGVudHJ5LnRleHRTcGFuKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufTtcclxudmFyIFJlZmVyZW5jZUFkYXB0ZXIgPSBjbGFzcyBleHRlbmRzIEFkYXB0ZXIge1xyXG4gIGNvbnN0cnVjdG9yKF9saWJGaWxlcywgd29ya2VyKSB7XHJcbiAgICBzdXBlcih3b3JrZXIpO1xyXG4gICAgdGhpcy5fbGliRmlsZXMgPSBfbGliRmlsZXM7XHJcbiAgfVxyXG4gIGFzeW5jIHByb3ZpZGVSZWZlcmVuY2VzKG1vZGVsLCBwb3NpdGlvbiwgY29udGV4dCwgdG9rZW4pIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0gbW9kZWwudXJpO1xyXG4gICAgY29uc3Qgb2Zmc2V0ID0gbW9kZWwuZ2V0T2Zmc2V0QXQocG9zaXRpb24pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZW50cmllcyA9IGF3YWl0IHdvcmtlci5nZXRSZWZlcmVuY2VzQXRQb3NpdGlvbihyZXNvdXJjZS50b1N0cmluZygpLCBvZmZzZXQpO1xyXG4gICAgaWYgKCFlbnRyaWVzIHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBhd2FpdCB0aGlzLl9saWJGaWxlcy5mZXRjaExpYkZpbGVzSWZOZWNlc3NhcnkoXHJcbiAgICAgIGVudHJpZXMubWFwKChlbnRyeSkgPT4gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMuVXJpLnBhcnNlKGVudHJ5LmZpbGVOYW1lKSlcclxuICAgICk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgZm9yIChsZXQgZW50cnkgb2YgZW50cmllcykge1xyXG4gICAgICBjb25zdCByZWZNb2RlbCA9IHRoaXMuX2xpYkZpbGVzLmdldE9yQ3JlYXRlTW9kZWwoZW50cnkuZmlsZU5hbWUpO1xyXG4gICAgICBpZiAocmVmTW9kZWwpIHtcclxuICAgICAgICByZXN1bHQucHVzaCh7XHJcbiAgICAgICAgICB1cmk6IHJlZk1vZGVsLnVyaSxcclxuICAgICAgICAgIHJhbmdlOiB0aGlzLl90ZXh0U3BhblRvUmFuZ2UocmVmTW9kZWwsIGVudHJ5LnRleHRTcGFuKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufTtcclxudmFyIE91dGxpbmVBZGFwdGVyID0gY2xhc3MgZXh0ZW5kcyBBZGFwdGVyIHtcclxuICBhc3luYyBwcm92aWRlRG9jdW1lbnRTeW1ib2xzKG1vZGVsLCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCB3b3JrZXIgPSBhd2FpdCB0aGlzLl93b3JrZXIocmVzb3VyY2UpO1xyXG4gICAgaWYgKG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCByb290ID0gYXdhaXQgd29ya2VyLmdldE5hdmlnYXRpb25UcmVlKHJlc291cmNlLnRvU3RyaW5nKCkpO1xyXG4gICAgaWYgKCFyb290IHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb252ZXJ0ID0gKGl0ZW0sIGNvbnRhaW5lckxhYmVsKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdDIgPSB7XHJcbiAgICAgICAgbmFtZTogaXRlbS50ZXh0LFxyXG4gICAgICAgIGRldGFpbDogXCJcIixcclxuICAgICAgICBraW5kOiBvdXRsaW5lVHlwZVRhYmxlW2l0ZW0ua2luZF0gfHwgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLlN5bWJvbEtpbmQuVmFyaWFibGUsXHJcbiAgICAgICAgcmFuZ2U6IHRoaXMuX3RleHRTcGFuVG9SYW5nZShtb2RlbCwgaXRlbS5zcGFuc1swXSksXHJcbiAgICAgICAgc2VsZWN0aW9uUmFuZ2U6IHRoaXMuX3RleHRTcGFuVG9SYW5nZShtb2RlbCwgaXRlbS5zcGFuc1swXSksXHJcbiAgICAgICAgdGFnczogW10sXHJcbiAgICAgICAgY2hpbGRyZW46IGl0ZW0uY2hpbGRJdGVtcz8ubWFwKChjaGlsZCkgPT4gY29udmVydChjaGlsZCwgaXRlbS50ZXh0KSksXHJcbiAgICAgICAgY29udGFpbmVyTmFtZTogY29udGFpbmVyTGFiZWxcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIHJlc3VsdDI7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVzdWx0ID0gcm9vdC5jaGlsZEl0ZW1zID8gcm9vdC5jaGlsZEl0ZW1zLm1hcCgoaXRlbSkgPT4gY29udmVydChpdGVtKSkgOiBbXTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59O1xyXG52YXIgS2luZCA9IGNsYXNzIHtcclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy51bmtub3duID0gXCJcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMua2V5d29yZCA9IFwia2V5d29yZFwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5zY3JpcHQgPSBcInNjcmlwdFwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5tb2R1bGUgPSBcIm1vZHVsZVwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5jbGFzcyA9IFwiY2xhc3NcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMuaW50ZXJmYWNlID0gXCJpbnRlcmZhY2VcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMudHlwZSA9IFwidHlwZVwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5lbnVtID0gXCJlbnVtXCI7XHJcbiAgfVxyXG4gIHN0YXRpYyB7XHJcbiAgICB0aGlzLnZhcmlhYmxlID0gXCJ2YXJcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMubG9jYWxWYXJpYWJsZSA9IFwibG9jYWwgdmFyXCI7XHJcbiAgfVxyXG4gIHN0YXRpYyB7XHJcbiAgICB0aGlzLmZ1bmN0aW9uID0gXCJmdW5jdGlvblwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5sb2NhbEZ1bmN0aW9uID0gXCJsb2NhbCBmdW5jdGlvblwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5tZW1iZXJGdW5jdGlvbiA9IFwibWV0aG9kXCI7XHJcbiAgfVxyXG4gIHN0YXRpYyB7XHJcbiAgICB0aGlzLm1lbWJlckdldEFjY2Vzc29yID0gXCJnZXR0ZXJcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMubWVtYmVyU2V0QWNjZXNzb3IgPSBcInNldHRlclwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5tZW1iZXJWYXJpYWJsZSA9IFwicHJvcGVydHlcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMuY29uc3RydWN0b3JJbXBsZW1lbnRhdGlvbiA9IFwiY29uc3RydWN0b3JcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMuY2FsbFNpZ25hdHVyZSA9IFwiY2FsbFwiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5pbmRleFNpZ25hdHVyZSA9IFwiaW5kZXhcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMuY29uc3RydWN0U2lnbmF0dXJlID0gXCJjb25zdHJ1Y3RcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMucGFyYW1ldGVyID0gXCJwYXJhbWV0ZXJcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMudHlwZVBhcmFtZXRlciA9IFwidHlwZSBwYXJhbWV0ZXJcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMucHJpbWl0aXZlVHlwZSA9IFwicHJpbWl0aXZlIHR5cGVcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMubGFiZWwgPSBcImxhYmVsXCI7XHJcbiAgfVxyXG4gIHN0YXRpYyB7XHJcbiAgICB0aGlzLmFsaWFzID0gXCJhbGlhc1wiO1xyXG4gIH1cclxuICBzdGF0aWMge1xyXG4gICAgdGhpcy5jb25zdCA9IFwiY29uc3RcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMubGV0ID0gXCJsZXRcIjtcclxuICB9XHJcbiAgc3RhdGljIHtcclxuICAgIHRoaXMud2FybmluZyA9IFwid2FybmluZ1wiO1xyXG4gIH1cclxufTtcclxudmFyIG91dGxpbmVUeXBlVGFibGUgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLm1vZHVsZV0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5Nb2R1bGU7XHJcbm91dGxpbmVUeXBlVGFibGVbS2luZC5jbGFzc10gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5DbGFzcztcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLmVudW1dID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLlN5bWJvbEtpbmQuRW51bTtcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLmludGVyZmFjZV0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5JbnRlcmZhY2U7XHJcbm91dGxpbmVUeXBlVGFibGVbS2luZC5tZW1iZXJGdW5jdGlvbl0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5NZXRob2Q7XHJcbm91dGxpbmVUeXBlVGFibGVbS2luZC5tZW1iZXJWYXJpYWJsZV0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5Qcm9wZXJ0eTtcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLm1lbWJlckdldEFjY2Vzc29yXSA9IG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5TeW1ib2xLaW5kLlByb3BlcnR5O1xyXG5vdXRsaW5lVHlwZVRhYmxlW0tpbmQubWVtYmVyU2V0QWNjZXNzb3JdID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLlN5bWJvbEtpbmQuUHJvcGVydHk7XHJcbm91dGxpbmVUeXBlVGFibGVbS2luZC52YXJpYWJsZV0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5WYXJpYWJsZTtcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLmNvbnN0XSA9IG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5TeW1ib2xLaW5kLlZhcmlhYmxlO1xyXG5vdXRsaW5lVHlwZVRhYmxlW0tpbmQubG9jYWxWYXJpYWJsZV0gPSBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuU3ltYm9sS2luZC5WYXJpYWJsZTtcclxub3V0bGluZVR5cGVUYWJsZVtLaW5kLnZhcmlhYmxlXSA9IG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5TeW1ib2xLaW5kLlZhcmlhYmxlO1xyXG5vdXRsaW5lVHlwZVRhYmxlW0tpbmQuZnVuY3Rpb25dID0gbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLlN5bWJvbEtpbmQuRnVuY3Rpb247XHJcbm91dGxpbmVUeXBlVGFibGVbS2luZC5sb2NhbEZ1bmN0aW9uXSA9IG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5TeW1ib2xLaW5kLkZ1bmN0aW9uO1xyXG52YXIgRm9ybWF0SGVscGVyID0gY2xhc3MgZXh0ZW5kcyBBZGFwdGVyIHtcclxuICBzdGF0aWMgX2NvbnZlcnRPcHRpb25zKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIENvbnZlcnRUYWJzVG9TcGFjZXM6IG9wdGlvbnMuaW5zZXJ0U3BhY2VzLFxyXG4gICAgICBUYWJTaXplOiBvcHRpb25zLnRhYlNpemUsXHJcbiAgICAgIEluZGVudFNpemU6IG9wdGlvbnMudGFiU2l6ZSxcclxuICAgICAgSW5kZW50U3R5bGU6IDIgLyogU21hcnQgKi8sXHJcbiAgICAgIE5ld0xpbmVDaGFyYWN0ZXI6IFwiXFxuXCIsXHJcbiAgICAgIEluc2VydFNwYWNlQWZ0ZXJDb21tYURlbGltaXRlcjogdHJ1ZSxcclxuICAgICAgSW5zZXJ0U3BhY2VBZnRlclNlbWljb2xvbkluRm9yU3RhdGVtZW50czogdHJ1ZSxcclxuICAgICAgSW5zZXJ0U3BhY2VCZWZvcmVBbmRBZnRlckJpbmFyeU9wZXJhdG9yczogdHJ1ZSxcclxuICAgICAgSW5zZXJ0U3BhY2VBZnRlcktleXdvcmRzSW5Db250cm9sRmxvd1N0YXRlbWVudHM6IHRydWUsXHJcbiAgICAgIEluc2VydFNwYWNlQWZ0ZXJGdW5jdGlvbktleXdvcmRGb3JBbm9ueW1vdXNGdW5jdGlvbnM6IHRydWUsXHJcbiAgICAgIEluc2VydFNwYWNlQWZ0ZXJPcGVuaW5nQW5kQmVmb3JlQ2xvc2luZ05vbmVtcHR5UGFyZW50aGVzaXM6IGZhbHNlLFxyXG4gICAgICBJbnNlcnRTcGFjZUFmdGVyT3BlbmluZ0FuZEJlZm9yZUNsb3NpbmdOb25lbXB0eUJyYWNrZXRzOiBmYWxzZSxcclxuICAgICAgSW5zZXJ0U3BhY2VBZnRlck9wZW5pbmdBbmRCZWZvcmVDbG9zaW5nVGVtcGxhdGVTdHJpbmdCcmFjZXM6IGZhbHNlLFxyXG4gICAgICBQbGFjZU9wZW5CcmFjZU9uTmV3TGluZUZvckNvbnRyb2xCbG9ja3M6IGZhbHNlLFxyXG4gICAgICBQbGFjZU9wZW5CcmFjZU9uTmV3TGluZUZvckZ1bmN0aW9uczogZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG4gIF9jb252ZXJ0VGV4dENoYW5nZXMobW9kZWwsIGNoYW5nZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGV4dDogY2hhbmdlLm5ld1RleHQsXHJcbiAgICAgIHJhbmdlOiB0aGlzLl90ZXh0U3BhblRvUmFuZ2UobW9kZWwsIGNoYW5nZS5zcGFuKVxyXG4gICAgfTtcclxuICB9XHJcbn07XHJcbnZhciBGb3JtYXRBZGFwdGVyID0gY2xhc3MgZXh0ZW5kcyBGb3JtYXRIZWxwZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcclxuICAgIHRoaXMuY2FuRm9ybWF0TXVsdGlwbGVSYW5nZXMgPSBmYWxzZTtcclxuICB9XHJcbiAgYXN5bmMgcHJvdmlkZURvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdHMobW9kZWwsIHJhbmdlLCBvcHRpb25zLCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCBzdGFydE9mZnNldCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2Uuc3RhcnRMaW5lTnVtYmVyLFxyXG4gICAgICBjb2x1bW46IHJhbmdlLnN0YXJ0Q29sdW1uXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGVuZE9mZnNldCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2UuZW5kTGluZU51bWJlcixcclxuICAgICAgY29sdW1uOiByYW5nZS5lbmRDb2x1bW5cclxuICAgIH0pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZWRpdHMgPSBhd2FpdCB3b3JrZXIuZ2V0Rm9ybWF0dGluZ0VkaXRzRm9yUmFuZ2UoXHJcbiAgICAgIHJlc291cmNlLnRvU3RyaW5nKCksXHJcbiAgICAgIHN0YXJ0T2Zmc2V0LFxyXG4gICAgICBlbmRPZmZzZXQsXHJcbiAgICAgIEZvcm1hdEhlbHBlci5fY29udmVydE9wdGlvbnMob3B0aW9ucylcclxuICAgICk7XHJcbiAgICBpZiAoIWVkaXRzIHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZWRpdHMubWFwKChlZGl0KSA9PiB0aGlzLl9jb252ZXJ0VGV4dENoYW5nZXMobW9kZWwsIGVkaXQpKTtcclxuICB9XHJcbn07XHJcbnZhciBGb3JtYXRPblR5cGVBZGFwdGVyID0gY2xhc3MgZXh0ZW5kcyBGb3JtYXRIZWxwZXIge1xyXG4gIGdldCBhdXRvRm9ybWF0VHJpZ2dlckNoYXJhY3RlcnMoKSB7XHJcbiAgICByZXR1cm4gW1wiO1wiLCBcIn1cIiwgXCJcXG5cIl07XHJcbiAgfVxyXG4gIGFzeW5jIHByb3ZpZGVPblR5cGVGb3JtYXR0aW5nRWRpdHMobW9kZWwsIHBvc2l0aW9uLCBjaCwgb3B0aW9ucywgdG9rZW4pIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0gbW9kZWwudXJpO1xyXG4gICAgY29uc3Qgb2Zmc2V0ID0gbW9kZWwuZ2V0T2Zmc2V0QXQocG9zaXRpb24pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZWRpdHMgPSBhd2FpdCB3b3JrZXIuZ2V0Rm9ybWF0dGluZ0VkaXRzQWZ0ZXJLZXlzdHJva2UoXHJcbiAgICAgIHJlc291cmNlLnRvU3RyaW5nKCksXHJcbiAgICAgIG9mZnNldCxcclxuICAgICAgY2gsXHJcbiAgICAgIEZvcm1hdEhlbHBlci5fY29udmVydE9wdGlvbnMob3B0aW9ucylcclxuICAgICk7XHJcbiAgICBpZiAoIWVkaXRzIHx8IG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZWRpdHMubWFwKChlZGl0KSA9PiB0aGlzLl9jb252ZXJ0VGV4dENoYW5nZXMobW9kZWwsIGVkaXQpKTtcclxuICB9XHJcbn07XHJcbnZhciBDb2RlQWN0aW9uQWRhcHRvciA9IGNsYXNzIGV4dGVuZHMgRm9ybWF0SGVscGVyIHtcclxuICBhc3luYyBwcm92aWRlQ29kZUFjdGlvbnMobW9kZWwsIHJhbmdlLCBjb250ZXh0LCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCBzdGFydCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2Uuc3RhcnRMaW5lTnVtYmVyLFxyXG4gICAgICBjb2x1bW46IHJhbmdlLnN0YXJ0Q29sdW1uXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGVuZCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2UuZW5kTGluZU51bWJlcixcclxuICAgICAgY29sdW1uOiByYW5nZS5lbmRDb2x1bW5cclxuICAgIH0pO1xyXG4gICAgY29uc3QgZm9ybWF0T3B0aW9ucyA9IEZvcm1hdEhlbHBlci5fY29udmVydE9wdGlvbnMobW9kZWwuZ2V0T3B0aW9ucygpKTtcclxuICAgIGNvbnN0IGVycm9yQ29kZXMgPSBjb250ZXh0Lm1hcmtlcnMuZmlsdGVyKChtKSA9PiBtLmNvZGUpLm1hcCgobSkgPT4gbS5jb2RlKS5tYXAoTnVtYmVyKTtcclxuICAgIGNvbnN0IHdvcmtlciA9IGF3YWl0IHRoaXMuX3dvcmtlcihyZXNvdXJjZSk7XHJcbiAgICBpZiAobW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvZGVGaXhlcyA9IGF3YWl0IHdvcmtlci5nZXRDb2RlRml4ZXNBdFBvc2l0aW9uKFxyXG4gICAgICByZXNvdXJjZS50b1N0cmluZygpLFxyXG4gICAgICBzdGFydCxcclxuICAgICAgZW5kLFxyXG4gICAgICBlcnJvckNvZGVzLFxyXG4gICAgICBmb3JtYXRPcHRpb25zXHJcbiAgICApO1xyXG4gICAgaWYgKCFjb2RlRml4ZXMgfHwgbW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybiB7IGFjdGlvbnM6IFtdLCBkaXNwb3NlOiAoKSA9PiB7XHJcbiAgICAgIH0gfTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFjdGlvbnMgPSBjb2RlRml4ZXMuZmlsdGVyKChmaXgpID0+IHtcclxuICAgICAgcmV0dXJuIGZpeC5jaGFuZ2VzLmZpbHRlcigoY2hhbmdlKSA9PiBjaGFuZ2UuaXNOZXdGaWxlKS5sZW5ndGggPT09IDA7XHJcbiAgICB9KS5tYXAoKGZpeCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fdHNDb2RlRml4QWN0aW9uVG9Nb25hY29Db2RlQWN0aW9uKG1vZGVsLCBjb250ZXh0LCBmaXgpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhY3Rpb25zLFxyXG4gICAgICBkaXNwb3NlOiAoKSA9PiB7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG4gIF90c0NvZGVGaXhBY3Rpb25Ub01vbmFjb0NvZGVBY3Rpb24obW9kZWwsIGNvbnRleHQsIGNvZGVGaXgpIHtcclxuICAgIGNvbnN0IGVkaXRzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGNoYW5nZSBvZiBjb2RlRml4LmNoYW5nZXMpIHtcclxuICAgICAgZm9yIChjb25zdCB0ZXh0Q2hhbmdlIG9mIGNoYW5nZS50ZXh0Q2hhbmdlcykge1xyXG4gICAgICAgIGVkaXRzLnB1c2goe1xyXG4gICAgICAgICAgcmVzb3VyY2U6IG1vZGVsLnVyaSxcclxuICAgICAgICAgIHZlcnNpb25JZDogdm9pZCAwLFxyXG4gICAgICAgICAgdGV4dEVkaXQ6IHtcclxuICAgICAgICAgICAgcmFuZ2U6IHRoaXMuX3RleHRTcGFuVG9SYW5nZShtb2RlbCwgdGV4dENoYW5nZS5zcGFuKSxcclxuICAgICAgICAgICAgdGV4dDogdGV4dENoYW5nZS5uZXdUZXh0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGFjdGlvbiA9IHtcclxuICAgICAgdGl0bGU6IGNvZGVGaXguZGVzY3JpcHRpb24sXHJcbiAgICAgIGVkaXQ6IHsgZWRpdHMgfSxcclxuICAgICAgZGlhZ25vc3RpY3M6IGNvbnRleHQubWFya2VycyxcclxuICAgICAga2luZDogXCJxdWlja2ZpeFwiXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGFjdGlvbjtcclxuICB9XHJcbn07XHJcbnZhciBSZW5hbWVBZGFwdGVyID0gY2xhc3MgZXh0ZW5kcyBBZGFwdGVyIHtcclxuICBjb25zdHJ1Y3RvcihfbGliRmlsZXMsIHdvcmtlcikge1xyXG4gICAgc3VwZXIod29ya2VyKTtcclxuICAgIHRoaXMuX2xpYkZpbGVzID0gX2xpYkZpbGVzO1xyXG4gIH1cclxuICBhc3luYyBwcm92aWRlUmVuYW1lRWRpdHMobW9kZWwsIHBvc2l0aW9uLCBuZXdOYW1lLCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IHJlc291cmNlLnRvU3RyaW5nKCk7XHJcbiAgICBjb25zdCBvZmZzZXQgPSBtb2RlbC5nZXRPZmZzZXRBdChwb3NpdGlvbik7XHJcbiAgICBjb25zdCB3b3JrZXIgPSBhd2FpdCB0aGlzLl93b3JrZXIocmVzb3VyY2UpO1xyXG4gICAgaWYgKG1vZGVsLmlzRGlzcG9zZWQoKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCByZW5hbWVJbmZvID0gYXdhaXQgd29ya2VyLmdldFJlbmFtZUluZm8oZmlsZU5hbWUsIG9mZnNldCwge1xyXG4gICAgICBhbGxvd1JlbmFtZU9mSW1wb3J0UGF0aDogZmFsc2VcclxuICAgIH0pO1xyXG4gICAgaWYgKHJlbmFtZUluZm8uY2FuUmVuYW1lID09PSBmYWxzZSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVkaXRzOiBbXSxcclxuICAgICAgICByZWplY3RSZWFzb246IHJlbmFtZUluZm8ubG9jYWxpemVkRXJyb3JNZXNzYWdlXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBpZiAocmVuYW1lSW5mby5maWxlVG9SZW5hbWUgIT09IHZvaWQgMCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZW5hbWluZyBmaWxlcyBpcyBub3Qgc3VwcG9ydGVkLlwiKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlbmFtZUxvY2F0aW9ucyA9IGF3YWl0IHdvcmtlci5maW5kUmVuYW1lTG9jYXRpb25zKFxyXG4gICAgICBmaWxlTmFtZSxcclxuICAgICAgb2Zmc2V0LFxyXG4gICAgICAvKnN0cmluZ3MqL1xyXG4gICAgICBmYWxzZSxcclxuICAgICAgLypjb21tZW50cyovXHJcbiAgICAgIGZhbHNlLFxyXG4gICAgICAvKnByZWZpeEFuZFN1ZmZpeCovXHJcbiAgICAgIGZhbHNlXHJcbiAgICApO1xyXG4gICAgaWYgKCFyZW5hbWVMb2NhdGlvbnMgfHwgbW9kZWwuaXNEaXNwb3NlZCgpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGVkaXRzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHJlbmFtZUxvY2F0aW9uIG9mIHJlbmFtZUxvY2F0aW9ucykge1xyXG4gICAgICBjb25zdCBtb2RlbDIgPSB0aGlzLl9saWJGaWxlcy5nZXRPckNyZWF0ZU1vZGVsKHJlbmFtZUxvY2F0aW9uLmZpbGVOYW1lKTtcclxuICAgICAgaWYgKG1vZGVsMikge1xyXG4gICAgICAgIGVkaXRzLnB1c2goe1xyXG4gICAgICAgICAgcmVzb3VyY2U6IG1vZGVsMi51cmksXHJcbiAgICAgICAgICB2ZXJzaW9uSWQ6IHZvaWQgMCxcclxuICAgICAgICAgIHRleHRFZGl0OiB7XHJcbiAgICAgICAgICAgIHJhbmdlOiB0aGlzLl90ZXh0U3BhblRvUmFuZ2UobW9kZWwyLCByZW5hbWVMb2NhdGlvbi50ZXh0U3BhbiksXHJcbiAgICAgICAgICAgIHRleHQ6IG5ld05hbWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gZmlsZSAke3JlbmFtZUxvY2F0aW9uLmZpbGVOYW1lfS5gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHsgZWRpdHMgfTtcclxuICB9XHJcbn07XHJcbnZhciBJbmxheUhpbnRzQWRhcHRlciA9IGNsYXNzIGV4dGVuZHMgQWRhcHRlciB7XHJcbiAgYXN5bmMgcHJvdmlkZUlubGF5SGludHMobW9kZWwsIHJhbmdlLCB0b2tlbikge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBtb2RlbC51cmk7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IHJlc291cmNlLnRvU3RyaW5nKCk7XHJcbiAgICBjb25zdCBzdGFydCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2Uuc3RhcnRMaW5lTnVtYmVyLFxyXG4gICAgICBjb2x1bW46IHJhbmdlLnN0YXJ0Q29sdW1uXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGVuZCA9IG1vZGVsLmdldE9mZnNldEF0KHtcclxuICAgICAgbGluZU51bWJlcjogcmFuZ2UuZW5kTGluZU51bWJlcixcclxuICAgICAgY29sdW1uOiByYW5nZS5lbmRDb2x1bW5cclxuICAgIH0pO1xyXG4gICAgY29uc3Qgd29ya2VyID0gYXdhaXQgdGhpcy5fd29ya2VyKHJlc291cmNlKTtcclxuICAgIGlmIChtb2RlbC5pc0Rpc3Bvc2VkKCkpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBjb25zdCB0c0hpbnRzID0gYXdhaXQgd29ya2VyLnByb3ZpZGVJbmxheUhpbnRzKGZpbGVOYW1lLCBzdGFydCwgZW5kKTtcclxuICAgIGNvbnN0IGhpbnRzID0gdHNIaW50cy5tYXAoKGhpbnQpID0+IHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICAuLi5oaW50LFxyXG4gICAgICAgIGxhYmVsOiBoaW50LnRleHQsXHJcbiAgICAgICAgcG9zaXRpb246IG1vZGVsLmdldFBvc2l0aW9uQXQoaGludC5wb3NpdGlvbiksXHJcbiAgICAgICAga2luZDogdGhpcy5fY29udmVydEhpbnRLaW5kKGhpbnQua2luZClcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHsgaGludHMsIGRpc3Bvc2U6ICgpID0+IHtcclxuICAgIH0gfTtcclxuICB9XHJcbiAgX2NvbnZlcnRIaW50S2luZChraW5kKSB7XHJcbiAgICBzd2l0Y2ggKGtpbmQpIHtcclxuICAgICAgY2FzZSBcIlBhcmFtZXRlclwiOlxyXG4gICAgICAgIHJldHVybiBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMuSW5sYXlIaW50S2luZC5QYXJhbWV0ZXI7XHJcbiAgICAgIGNhc2UgXCJUeXBlXCI6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5JbmxheUhpbnRLaW5kLlR5cGU7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5JbmxheUhpbnRLaW5kLlR5cGU7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gc3JjL2xhbmd1YWdlL3R5cGVzY3JpcHQvdHNNb2RlLnRzXHJcbnZhciBqYXZhU2NyaXB0V29ya2VyO1xyXG52YXIgdHlwZVNjcmlwdFdvcmtlcjtcclxuZnVuY3Rpb24gc2V0dXBUeXBlU2NyaXB0KGRlZmF1bHRzKSB7XHJcbiAgdHlwZVNjcmlwdFdvcmtlciA9IHNldHVwTW9kZShkZWZhdWx0cywgXCJ0eXBlc2NyaXB0XCIpO1xyXG59XHJcbmZ1bmN0aW9uIHNldHVwSmF2YVNjcmlwdChkZWZhdWx0cykge1xyXG4gIGphdmFTY3JpcHRXb3JrZXIgPSBzZXR1cE1vZGUoZGVmYXVsdHMsIFwiamF2YXNjcmlwdFwiKTtcclxufVxyXG5mdW5jdGlvbiBnZXRKYXZhU2NyaXB0V29ya2VyKCkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBpZiAoIWphdmFTY3JpcHRXb3JrZXIpIHtcclxuICAgICAgcmV0dXJuIHJlamVjdChcIkphdmFTY3JpcHQgbm90IHJlZ2lzdGVyZWQhXCIpO1xyXG4gICAgfVxyXG4gICAgcmVzb2x2ZShqYXZhU2NyaXB0V29ya2VyKTtcclxuICB9KTtcclxufVxyXG5mdW5jdGlvbiBnZXRUeXBlU2NyaXB0V29ya2VyKCkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBpZiAoIXR5cGVTY3JpcHRXb3JrZXIpIHtcclxuICAgICAgcmV0dXJuIHJlamVjdChcIlR5cGVTY3JpcHQgbm90IHJlZ2lzdGVyZWQhXCIpO1xyXG4gICAgfVxyXG4gICAgcmVzb2x2ZSh0eXBlU2NyaXB0V29ya2VyKTtcclxuICB9KTtcclxufVxyXG5mdW5jdGlvbiBzZXR1cE1vZGUoZGVmYXVsdHMsIG1vZGVJZCkge1xyXG4gIGNvbnN0IGRpc3Bvc2FibGVzID0gW107XHJcbiAgY29uc3QgcHJvdmlkZXJzID0gW107XHJcbiAgY29uc3QgY2xpZW50ID0gbmV3IFdvcmtlck1hbmFnZXIobW9kZUlkLCBkZWZhdWx0cyk7XHJcbiAgZGlzcG9zYWJsZXMucHVzaChjbGllbnQpO1xyXG4gIGNvbnN0IHdvcmtlciA9ICguLi51cmlzKSA9PiB7XHJcbiAgICByZXR1cm4gY2xpZW50LmdldExhbmd1YWdlU2VydmljZVdvcmtlciguLi51cmlzKTtcclxuICB9O1xyXG4gIGNvbnN0IGxpYkZpbGVzID0gbmV3IExpYkZpbGVzKHdvcmtlcik7XHJcbiAgZnVuY3Rpb24gcmVnaXN0ZXJQcm92aWRlcnMoKSB7XHJcbiAgICBjb25zdCB7IG1vZGVDb25maWd1cmF0aW9uIH0gPSBkZWZhdWx0cztcclxuICAgIGRpc3Bvc2VBbGwocHJvdmlkZXJzKTtcclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5jb21wbGV0aW9uSXRlbXMpIHtcclxuICAgICAgcHJvdmlkZXJzLnB1c2goXHJcbiAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLnJlZ2lzdGVyQ29tcGxldGlvbkl0ZW1Qcm92aWRlcihcclxuICAgICAgICAgIG1vZGVJZCxcclxuICAgICAgICAgIG5ldyBTdWdnZXN0QWRhcHRlcih3b3JrZXIpXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgaWYgKG1vZGVDb25maWd1cmF0aW9uLnNpZ25hdHVyZUhlbHApIHtcclxuICAgICAgcHJvdmlkZXJzLnB1c2goXHJcbiAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLnJlZ2lzdGVyU2lnbmF0dXJlSGVscFByb3ZpZGVyKFxyXG4gICAgICAgICAgbW9kZUlkLFxyXG4gICAgICAgICAgbmV3IFNpZ25hdHVyZUhlbHBBZGFwdGVyKHdvcmtlcilcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBpZiAobW9kZUNvbmZpZ3VyYXRpb24uaG92ZXJzKSB7XHJcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxyXG4gICAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5yZWdpc3RlckhvdmVyUHJvdmlkZXIobW9kZUlkLCBuZXcgUXVpY2tJbmZvQWRhcHRlcih3b3JrZXIpKVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgaWYgKG1vZGVDb25maWd1cmF0aW9uLmRvY3VtZW50SGlnaGxpZ2h0cykge1xyXG4gICAgICBwcm92aWRlcnMucHVzaChcclxuICAgICAgICBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMucmVnaXN0ZXJEb2N1bWVudEhpZ2hsaWdodFByb3ZpZGVyKFxyXG4gICAgICAgICAgbW9kZUlkLFxyXG4gICAgICAgICAgbmV3IERvY3VtZW50SGlnaGxpZ2h0QWRhcHRlcih3b3JrZXIpXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgaWYgKG1vZGVDb25maWd1cmF0aW9uLmRlZmluaXRpb25zKSB7XHJcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxyXG4gICAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5yZWdpc3RlckRlZmluaXRpb25Qcm92aWRlcihcclxuICAgICAgICAgIG1vZGVJZCxcclxuICAgICAgICAgIG5ldyBEZWZpbml0aW9uQWRhcHRlcihsaWJGaWxlcywgd29ya2VyKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5yZWZlcmVuY2VzKSB7XHJcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxyXG4gICAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5yZWdpc3RlclJlZmVyZW5jZVByb3ZpZGVyKFxyXG4gICAgICAgICAgbW9kZUlkLFxyXG4gICAgICAgICAgbmV3IFJlZmVyZW5jZUFkYXB0ZXIobGliRmlsZXMsIHdvcmtlcilcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBpZiAobW9kZUNvbmZpZ3VyYXRpb24uZG9jdW1lbnRTeW1ib2xzKSB7XHJcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxyXG4gICAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5yZWdpc3RlckRvY3VtZW50U3ltYm9sUHJvdmlkZXIoXHJcbiAgICAgICAgICBtb2RlSWQsXHJcbiAgICAgICAgICBuZXcgT3V0bGluZUFkYXB0ZXIod29ya2VyKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5yZW5hbWUpIHtcclxuICAgICAgcHJvdmlkZXJzLnB1c2goXHJcbiAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLnJlZ2lzdGVyUmVuYW1lUHJvdmlkZXIoXHJcbiAgICAgICAgICBtb2RlSWQsXHJcbiAgICAgICAgICBuZXcgUmVuYW1lQWRhcHRlcihsaWJGaWxlcywgd29ya2VyKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5kb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzKSB7XHJcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxyXG4gICAgICAgIG1vbmFjb19lZGl0b3JfY29yZV9leHBvcnRzLmxhbmd1YWdlcy5yZWdpc3RlckRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKFxyXG4gICAgICAgICAgbW9kZUlkLFxyXG4gICAgICAgICAgbmV3IEZvcm1hdEFkYXB0ZXIod29ya2VyKVxyXG4gICAgICAgIClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5vblR5cGVGb3JtYXR0aW5nRWRpdHMpIHtcclxuICAgICAgcHJvdmlkZXJzLnB1c2goXHJcbiAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLnJlZ2lzdGVyT25UeXBlRm9ybWF0dGluZ0VkaXRQcm92aWRlcihcclxuICAgICAgICAgIG1vZGVJZCxcclxuICAgICAgICAgIG5ldyBGb3JtYXRPblR5cGVBZGFwdGVyKHdvcmtlcilcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBpZiAobW9kZUNvbmZpZ3VyYXRpb24uY29kZUFjdGlvbnMpIHtcclxuICAgICAgcHJvdmlkZXJzLnB1c2goXHJcbiAgICAgICAgbW9uYWNvX2VkaXRvcl9jb3JlX2V4cG9ydHMubGFuZ3VhZ2VzLnJlZ2lzdGVyQ29kZUFjdGlvblByb3ZpZGVyKG1vZGVJZCwgbmV3IENvZGVBY3Rpb25BZGFwdG9yKHdvcmtlcikpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBpZiAobW9kZUNvbmZpZ3VyYXRpb24uaW5sYXlIaW50cykge1xyXG4gICAgICBwcm92aWRlcnMucHVzaChcclxuICAgICAgICBtb25hY29fZWRpdG9yX2NvcmVfZXhwb3J0cy5sYW5ndWFnZXMucmVnaXN0ZXJJbmxheUhpbnRzUHJvdmlkZXIobW9kZUlkLCBuZXcgSW5sYXlIaW50c0FkYXB0ZXIod29ya2VyKSlcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChtb2RlQ29uZmlndXJhdGlvbi5kaWFnbm9zdGljcykge1xyXG4gICAgICBwcm92aWRlcnMucHVzaChuZXcgRGlhZ25vc3RpY3NBZGFwdGVyKGxpYkZpbGVzLCBkZWZhdWx0cywgbW9kZUlkLCB3b3JrZXIpKTtcclxuICAgIH1cclxuICB9XHJcbiAgcmVnaXN0ZXJQcm92aWRlcnMoKTtcclxuICBkaXNwb3NhYmxlcy5wdXNoKGFzRGlzcG9zYWJsZShwcm92aWRlcnMpKTtcclxuICByZXR1cm4gd29ya2VyO1xyXG59XHJcbmZ1bmN0aW9uIGFzRGlzcG9zYWJsZShkaXNwb3NhYmxlcykge1xyXG4gIHJldHVybiB7IGRpc3Bvc2U6ICgpID0+IGRpc3Bvc2VBbGwoZGlzcG9zYWJsZXMpIH07XHJcbn1cclxuZnVuY3Rpb24gZGlzcG9zZUFsbChkaXNwb3NhYmxlcykge1xyXG4gIHdoaWxlIChkaXNwb3NhYmxlcy5sZW5ndGgpIHtcclxuICAgIGRpc3Bvc2FibGVzLnBvcCgpLmRpc3Bvc2UoKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IHtcclxuICBBZGFwdGVyLFxyXG4gIENvZGVBY3Rpb25BZGFwdG9yLFxyXG4gIERlZmluaXRpb25BZGFwdGVyLFxyXG4gIERpYWdub3N0aWNzQWRhcHRlcixcclxuICBEb2N1bWVudEhpZ2hsaWdodEFkYXB0ZXIsXHJcbiAgRm9ybWF0QWRhcHRlcixcclxuICBGb3JtYXRIZWxwZXIsXHJcbiAgRm9ybWF0T25UeXBlQWRhcHRlcixcclxuICBJbmxheUhpbnRzQWRhcHRlcixcclxuICBLaW5kLFxyXG4gIExpYkZpbGVzLFxyXG4gIE91dGxpbmVBZGFwdGVyLFxyXG4gIFF1aWNrSW5mb0FkYXB0ZXIsXHJcbiAgUmVmZXJlbmNlQWRhcHRlcixcclxuICBSZW5hbWVBZGFwdGVyLFxyXG4gIFNpZ25hdHVyZUhlbHBBZGFwdGVyLFxyXG4gIFN1Z2dlc3RBZGFwdGVyLFxyXG4gIFdvcmtlck1hbmFnZXIsXHJcbiAgZmxhdHRlbkRpYWdub3N0aWNNZXNzYWdlVGV4dCxcclxuICBnZXRKYXZhU2NyaXB0V29ya2VyLFxyXG4gIGdldFR5cGVTY3JpcHRXb3JrZXIsXHJcbiAgc2V0dXBKYXZhU2NyaXB0LFxyXG4gIHNldHVwVHlwZVNjcmlwdFxyXG59O1xyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/monaco-editor/esm/vs/language/typescript/tsMode.js\n");

/***/ })

}]);